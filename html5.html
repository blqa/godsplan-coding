<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GodsPlan | HTML5 Master Course</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Iconos Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        orange: {
                            400: '#fb923c',
                            500: '#f97316',
                            600: '#ea580c',
                            900: '#7c2d12',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shake': 'shake 0.5s cubic-bezier(.36,.07,.19,.97) both',
                        'float': 'float 3s ease-in-out infinite',
                    },
                    keyframes: {
                        'pulse-glow': {
                            '0%, 100%': { opacity: 1, boxShadow: '0 0 10px rgba(249, 115, 22, 0.5)' },
                            '50%': { opacity: .5, boxShadow: '0 0 20px rgba(249, 115, 22, 0.1)' },
                        },
                        shake: {
                            '10%, 90%': { transform: 'translate3d(-1px, 0, 0)' },
                            '20%, 80%': { transform: 'translate3d(2px, 0, 0)' },
                            '30%, 50%, 70%': { transform: 'translate3d(-4px, 0, 0)' },
                            '40%, 60%': { transform: 'translate3d(4px, 0, 0)' }
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #e2e8f0; }
        .font-mono { font-family: 'Fira Code', monospace; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #f97316; }

        /* Syntax Highlight Basics */
        .token-tag { color: #f97316; } 
        .token-attr { color: #fb923c; } 
        .token-val { color: #a3e635; } 
        .token-comment { color: #64748b; font-style: italic; }
        .token-punct { color: #94a3b8; }

        .code-editor-area {
            background-image: radial-gradient(#334155 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .nav-item.active {
            background: linear-gradient(to right, rgba(249, 115, 22, 0.15), transparent);
            border-left: 3px solid #f97316;
            color: #fb923c;
        }
        
        textarea:focus { outline: none; }
        
        /* Certificate Pattern */
        .cert-pattern {
            background-color: #ffffff;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23f97316' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* Estilos Educativos (Theory Styling) */
        .concept-card {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(51, 65, 85, 0.5);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
        }
        .concept-title {
            color: #fb923c;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .pro-tip {
            border-left: 4px solid #22c55e;
            background: rgba(34, 197, 94, 0.05);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .code-snippet {
            font-family: 'Fira Code', monospace;
            background: #0f172a;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            color: #e2e8f0;
            font-size: 0.85em;
            border: 1px solid #334155;
        }
        .block-code {
            font-family: 'Fira Code', monospace;
            background: #0b1120;
            padding: 1rem;
            border-radius: 0.5rem;
            color: #94a3b8;
            font-size: 0.85rem;
            border: 1px solid #1e293b;
            margin: 1rem 0;
            overflow-x: auto;
        }
        .text-content p {
            margin-bottom: 1rem;
            line-height: 1.7;
            color: #cbd5e1;
        }
        .text-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
            color: #cbd5e1;
        }
        .text-content li {
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden selection:bg-orange-500/30 selection:text-orange-200">

    <!-- Header -->
    <header class="h-16 border-b border-slate-800 bg-slate-950 flex items-center justify-between px-4 md:px-6 z-50 shrink-0 relative">
        <div class="absolute bottom-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-orange-500/50 to-transparent"></div>

        <div class="flex items-center gap-4">
            <button onclick="toggleSidebar()" class="lg:hidden p-2 text-slate-400 hover:text-white transition-colors">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
            
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-orange-600 to-orange-400 flex items-center justify-center shadow-lg shadow-orange-500/20 group relative overflow-hidden">
                    <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                    <i data-lucide="file-code-2" class="text-white w-6 h-6 relative z-10"></i>
                </div>
                <div>
                    <h1 class="font-bold text-white tracking-tight leading-none text-lg">
                        GodsPlan | <span class="text-orange-500">HTML5 Master</span>
                    </h1>
                    <div class="flex items-center gap-2">
                        <span class="text-[10px] text-slate-500 uppercase tracking-widest font-semibold" id="user-rank">Novato</span>
                        <div class="h-1 w-1 rounded-full bg-slate-600"></div>
                        <span class="text-[10px] text-orange-400 font-mono font-bold" id="user-xp">0 XP</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-4 md:gap-6">
            <!-- Glosario Button -->
            <button onclick="toggleGlossary()" class="hidden md:flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-900 border border-slate-800 text-xs font-medium text-slate-400 hover:text-white hover:border-orange-500/30 transition-all">
                <i data-lucide="book" class="w-3 h-3"></i> Glosario
            </button>

            <div class="hidden md:flex flex-col items-end w-32 lg:w-48">
                <div class="flex items-center gap-2 text-[10px] font-bold uppercase text-slate-500 mb-1">
                    <span>Progreso</span>
                    <span id="progress-text" class="text-orange-400">0%</span>
                </div>
                <div class="w-full h-1.5 bg-slate-900 rounded-full overflow-hidden border border-slate-800">
                    <div id="progress-bar" class="h-full bg-gradient-to-r from-orange-600 to-orange-400 w-0 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(249,115,22,0.5)]"></div>
                </div>
            </div>

            <a href="https://coding.godsplan.site/" onclick="window.location.reload()" class="group relative px-4 py-2 bg-slate-900 border border-slate-800 hover:border-orange-500/50 rounded-lg transition-all duration-300 flex items-center gap-2 text-sm text-slate-400 hover:text-white hover:-translate-y-0.5 shadow-lg hover:shadow-orange-500/10">
                <i data-lucide="log-out" class="w-4 h-4 group-hover:text-orange-500 transition-colors"></i>
            </a>
        </div>
    </header>

    <!-- Layout Principal -->
    <div class="flex-1 flex overflow-hidden relative bg-slate-950">
        
        <!-- Mobile Overlay -->
        <div id="mobile-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/80 z-30 opacity-0 pointer-events-none transition-opacity duration-300 lg:hidden backdrop-blur-sm"></div>

        <!-- Sidebar (Curriculum) -->
        <aside class="w-80 bg-slate-900/95 border-r border-slate-800 flex flex-col shrink-0 transition-transform duration-300 absolute lg:relative z-40 h-full -translate-x-full lg:translate-x-0 backdrop-blur-md" id="sidebar">
            <div class="p-5 border-b border-slate-800/50 flex justify-between items-center">
                <h2 class="text-xs font-bold text-slate-500 uppercase tracking-widest flex items-center gap-2">
                    <i data-lucide="map" class="w-3 h-3"></i> Ruta de Aprendizaje
                </h2>
                <button onclick="toggleSidebar()" class="lg:hidden text-slate-400 hover:text-orange-500"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            
            <nav id="module-list" class="flex-1 overflow-y-auto py-2 space-y-1 px-2 custom-scrollbar">
                <!-- Se llena con JS -->
            </nav>
            
            <div class="p-4 border-t border-slate-800/50 bg-slate-900">
                <button onclick="resetProgress()" class="w-full text-xs text-slate-500 hover:text-red-400 flex items-center justify-center gap-2 transition-colors py-2 border border-slate-800 rounded hover:bg-slate-800 hover:border-red-900/30">
                    <i data-lucide="trash-2" class="w-3 h-3"></i> Reiniciar Curso
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col lg:flex-row min-w-0 bg-slate-950 relative">
            
            <!-- Left: Theory & Workspace -->
            <section class="flex-1 overflow-y-auto scroll-smooth custom-scrollbar relative" id="scroll-container">
                <div class="max-w-4xl mx-auto p-6 lg:p-8 pb-32">
                    
                    <!-- Content Injection -->
                    <div id="lesson-content" class="mb-10 animate-[fadeIn_0.3s_ease-out] text-content"></div>

                    <!-- Interactive Workspace -->
                    <div id="workspace-area" class="hidden space-y-6">
                        
                        <!-- Editor Container -->
                        <div class="rounded-xl overflow-hidden border border-slate-800 bg-[#0b101b] shadow-2xl ring-1 ring-white/5">
                            <!-- Toolbar -->
                            <div class="bg-slate-900/80 backdrop-blur px-4 py-2 flex justify-between items-center border-b border-slate-800">
                                <div class="flex items-center gap-3">
                                    <div class="flex items-center gap-2">
                                        <div class="w-2 h-2 rounded-full bg-orange-500 animate-pulse"></div>
                                        <span class="text-xs font-bold text-slate-300 uppercase tracking-wider">Editor en Vivo</span>
                                    </div>
                                    <span id="difficulty-badge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-slate-800 text-slate-400 border border-slate-700 uppercase">
                                        Básico
                                    </span>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="resetCode()" title="Reiniciar Código" class="p-1.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded transition-colors">
                                        <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Instructions Panel -->
                            <div class="bg-slate-900/40 p-4 border-b border-slate-800/50 flex items-start gap-3">
                                <div class="mt-1 min-w-[20px]">
                                    <i data-lucide="terminal" class="w-4 h-4 text-orange-500"></i>
                                </div>
                                <p id="exercise-instruction" class="text-slate-300 text-sm leading-relaxed font-medium"></p>
                            </div>

                            <!-- Code Input -->
                            <div class="relative code-editor-area group">
                                <textarea id="code-input" spellcheck="false" 
                                    class="w-full h-64 bg-transparent p-5 font-mono text-sm text-slate-200 resize-y border-none focus:ring-0 leading-relaxed tab-size-4 placeholder-slate-700"
                                    placeholder="<!-- Tu código brillante aquí... -->"></textarea>
                            </div>

                            <!-- Footer Actions -->
                            <div class="p-4 bg-slate-900 border-t border-slate-800 flex flex-col sm:flex-row justify-between items-center gap-4">
                                <div id="feedback-msg" class="w-full sm:w-auto text-xs font-medium px-3 py-2 rounded transition-all opacity-0 text-center sm:text-left border border-transparent flex items-center gap-2"></div>
                                
                                <div class="flex gap-3 w-full sm:w-auto">
                                    <button onclick="showHint()" id="btn-help" class="hidden px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-400 hover:text-white border border-slate-700 rounded-lg transition-all text-xs font-bold uppercase tracking-wide items-center justify-center gap-2">
                                        <i data-lucide="life-buoy" class="w-3 h-3"></i> Pista
                                    </button>
                                    
                                    <button onclick="validateCode()" class="flex-1 sm:flex-none px-6 py-2 bg-gradient-to-r from-orange-600 to-orange-500 hover:from-orange-500 hover:to-orange-400 text-white text-xs font-bold uppercase tracking-widest rounded-lg shadow-[0_0_15px_rgba(249,115,22,0.3)] hover:shadow-[0_0_20px_rgba(249,115,22,0.5)] transition-all flex items-center justify-center gap-2 transform active:scale-95 group">
                                        <i data-lucide="play" class="w-3 h-3 fill-current group-hover:translate-x-0.5 transition-transform"></i> Verificar
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Quiz Section (Conditional) -->
                        <div id="quiz-container" class="hidden bg-slate-900/30 border border-slate-800 rounded-xl p-6 relative overflow-hidden transition-all duration-500">
                            <div class="absolute -right-10 -top-10 w-40 h-40 bg-orange-500/5 rounded-full blur-3xl"></div>
                            <div class="flex items-start gap-4 relative z-10">
                                <div class="w-10 h-10 rounded-lg bg-slate-800 flex items-center justify-center shrink-0 text-orange-500 border border-slate-700">
                                    <i data-lucide="help-circle" class="w-5 h-5"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-sm font-bold text-white mb-2 uppercase tracking-wide text-orange-400">Pregunta Rápida</h3>
                                    <p id="quiz-question" class="text-slate-300 mb-5 text-sm font-medium"></p>
                                    <div id="quiz-options" class="grid grid-cols-1 gap-2"></div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Navigation Footer -->
                    <div class="mt-12 flex justify-between items-center pt-8 border-t border-slate-800/50">
                        <button onclick="prevLesson()" id="btn-prev" class="group px-4 py-2 text-slate-500 hover:text-orange-400 transition-colors flex items-center gap-2 text-sm font-medium disabled:opacity-30 disabled:pointer-events-none">
                            <i data-lucide="arrow-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i> Anterior
                        </button>
                        <button onclick="nextLesson()" id="btn-next" class="px-6 py-2.5 bg-slate-800 text-white rounded-lg transition-all flex items-center gap-2 text-sm font-bold border border-slate-700 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            Siguiente Lección <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>

                </div>
            </section>

            <!-- Right: Live Preview Panel -->
            <section class="hidden lg:flex w-[45%] xl:w-[40%] flex-col border-l border-slate-800 bg-[#020617] relative z-10">
                
                <!-- Code Reference Tab -->
                <div class="h-10 bg-[#0f172a] border-b border-slate-800 flex items-end px-2 gap-1 shrink-0">
                    <div class="px-4 py-2 bg-slate-900 text-orange-400 text-xs font-mono border-t border-x border-slate-800 rounded-t-md flex items-center gap-2 relative top-[1px] border-b-slate-900 select-none">
                        <i data-lucide="code" class="w-3 h-3"></i> ejemplo.html
                    </div>
                </div>

                <!-- Example Code View -->
                <div class="h-1/3 overflow-hidden bg-[#0f172a] border-b border-slate-800 flex flex-col relative group">
                    <div class="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                         <span class="text-[10px] bg-slate-800 text-slate-400 px-2 py-1 rounded border border-slate-700 shadow-sm">Solo Lectura</span>
                    </div>
                    <pre id="reference-code" class="flex-1 p-5 font-mono text-xs text-slate-400 overflow-auto custom-scrollbar select-text leading-relaxed"></pre>
                </div>

                <!-- Preview Header -->
                <div class="h-9 bg-slate-100 border-b border-slate-200 flex items-center px-3 gap-2 shrink-0">
                    <div class="flex gap-1.5 opacity-50">
                        <div class="w-2.5 h-2.5 rounded-full bg-slate-400"></div>
                        <div class="w-2.5 h-2.5 rounded-full bg-slate-400"></div>
                        <div class="w-2.5 h-2.5 rounded-full bg-slate-400"></div>
                    </div>
                    <div class="flex-1 bg-white h-6 rounded border border-slate-200 flex items-center px-2 shadow-sm ml-2">
                        <i data-lucide="lock" class="w-2.5 h-2.5 text-slate-400 mr-1.5"></i>
                        <span class="text-[10px] text-slate-400 font-sans">localhost:8080/live-preview</span>
                    </div>
                    <div class="ml-auto flex items-center gap-1">
                        <span class="relative flex h-2 w-2">
                          <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                          <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                        </span>
                    </div>
                </div>
                
                <!-- Iframe Preview -->
                <div class="flex-1 bg-white relative">
                    <iframe id="preview-frame" class="w-full h-full border-none bg-white"></iframe>
                </div>
            </section>
        </main>
    </div>

    <!-- Glosario Modal -->
    <div id="glossary-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="toggleGlossary()"></div>
        <div class="bg-slate-900 border border-slate-800 w-full max-w-3xl max-h-[80vh] flex flex-col relative z-10 rounded-xl overflow-hidden shadow-2xl animate-[modal-in_0.3s_ease-out]">
            <div class="p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900/50">
                <h2 class="text-xl font-bold text-white flex items-center gap-2">
                    <i data-lucide="book-open" class="text-orange-500"></i> Glosario de Etiquetas
                </h2>
                <button onclick="toggleGlossary()" class="text-slate-400 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <div class="p-6 overflow-y-auto custom-scrollbar">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="glossary-content">
                    <!-- Se llena con JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Certificado -->
    <div id="certificate-modal" class="fixed inset-0 z-[100] hidden items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/90 backdrop-blur-md" onclick="closeCertModal()"></div>
        <div class="bg-white text-slate-900 w-full max-w-2xl relative z-10 rounded-xl overflow-hidden shadow-2xl transform scale-95 opacity-0 transition-all duration-700 cert-pattern" id="cert-content">
            <div class="border-8 border-double border-orange-500/20 m-2 p-8 text-center relative">
                <!-- Watermark -->
                <div class="absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none">
                    <i data-lucide="code-2" class="w-96 h-96"></i>
                </div>

                <div class="w-24 h-24 bg-orange-500 mx-auto rounded-full flex items-center justify-center mb-6 shadow-xl text-white">
                    <i data-lucide="award" class="w-12 h-12"></i>
                </div>
                
                <h2 class="text-4xl font-serif font-bold text-slate-800 mb-2">Certificado de Excelencia</h2>
                <p class="text-slate-500 uppercase tracking-widest text-xs font-bold mb-8">GodsPlan Coding Academy</p>
                
                <p class="text-lg text-slate-600 mb-2">Este documento certifica que</p>
                <h3 class="text-3xl font-bold text-orange-600 mb-6 font-mono" id="cert-name">Desarrollador Web</h3>
                
                <p class="text-slate-600 max-w-lg mx-auto leading-relaxed mb-8">
                    Ha completado satisfactoriamente los 20 módulos intensivos del curso <strong class="text-slate-800">HTML5 Master</strong>, demostrando competencia en estructura, semántica, formularios y multimedia.
                </p>
                
                <div class="flex justify-between items-end border-t border-slate-200 pt-6 mt-6">
                    <div class="text-left">
                        <div class="font-cursive text-2xl text-slate-800 opacity-70 mb-1">GodsPlan</div>
                        <p class="text-xs text-slate-400 uppercase mt-1">Instructor Principal</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-slate-400 uppercase">Fecha de Emisión</p>
                        <p class="text-sm font-mono font-bold text-slate-700" id="cert-date">12/12/2025</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-slate-900 p-4 flex justify-center gap-4">
                <button onclick="window.print()" class="px-6 py-2 bg-white text-slate-900 rounded font-bold hover:bg-orange-50 transition flex items-center gap-2">
                    <i data-lucide="printer" class="w-4 h-4"></i> Imprimir / PDF
                </button>
                <button onclick="closeCertModal()" class="px-6 py-2 border border-slate-700 text-slate-300 rounded hover:text-white transition">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Lógica Principal -->
    <script>
        // --- 1. DATOS DEL CURSO ---
        // Aquí es donde sucede la magia. CONTENIDO REAL Y EDUCATIVO.
        const curriculum = [
            // BASICS
            {
                id: "m01",
                title: "1. La Estructura Vital",
                desc: "Todo tiene un comienzo.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 01</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">HTML5 Boilerplate</h1>
                    
                    <p>Imagina que estás construyendo una casa. No puedes poner el techo sin los cimientos, ¿verdad? En la web, esos cimientos son la estructura básica de HTML.</p>

                    <div class="concept-card">
                        <div class="concept-title"><i data-lucide="layers"></i> Anatomía de un Archivo</div>
                        <p class="text-sm text-slate-300">
                            1. <span class="code-snippet">!DOCTYPE html</span>: Le grita al navegador "¡Oye! Esto es HTML5 moderno, no trates de adivinar".<br>
                            2. <span class="code-snippet">html</span>: La raíz. Todo vive aquí dentro.<br>
                            3. <span class="code-snippet">head</span>: El cerebro. Información invisible (metadatos, título de pestaña).<br>
                            4. <span class="code-snippet">body</span>: El cuerpo. Todo lo que el usuario ve en la pantalla.
                        </p>
                    </div>

                    <div class="pro-tip text-sm text-slate-300">
                        <strong>Tip Pro:</strong> Siempre indentamos el código (usamos espacios o tabulaciones) para ver qué etiqueta está dentro de cuál. ¡El orden evita el caos!
                    </div>
                `,
                codeRef: `<!DOCTYPE html>\n<html lang="es">\n  <head>\n    <title>Mi Primera Web</title>\n  </head>\n  <body>\n    <h1>¡Hola Mundo!</h1>\n  </body>\n</html>`,
                exercise: {
                    instruction: "Escribe la estructura base completa desde cero. No olvides el DOCTYPE, las etiquetas html, head (con un title 'Demo') y body.",
                    placeholder: "<!DOCTYPE html>\n...",
                    difficulty: "Básico",
                    hint: "La estructura es como una muñeca rusa: html > head/body.",
                    validate: (doc, str) => {
                        if(!str.toLowerCase().includes('<!doctype html>')) return {valid:false, msg:"¡Error Crítico! Falta el <!DOCTYPE html> al inicio."};
                        if(!doc.querySelector('html')) return {valid:false, msg:"Falta la etiqueta raíz <html>."};
                        if(!doc.querySelector('head')) return {valid:false, msg:"Tu página no tiene cerebro. Falta <head>."};
                        if(!doc.querySelector('body')) return {valid:false, msg:"Tu página es invisible. Falta <body>."};
                        if(doc.title !== 'Demo') return {valid:false, msg:"El título de la pestaña debe ser exactamente 'Demo'."};
                        return {valid:true, msg:"¡Perfecto! Has creado vida digital."};
                    }
                },
                quiz: { q: "¿Qué etiqueta contiene lo que ve el usuario?", options: ["<head>", "<body>", "<html5>"], correct: 1 }
            },
            {
                id: "m02",
                title: "2. Jerarquía de Títulos",
                desc: "Google ama el orden.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 02</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Los Encabezados (H1-H6)</h1>
                    
                    <p>Cuando lees un periódico, sabes qué es importante por el tamaño del título. En HTML, usamos <span class="code-snippet">h1</span> hasta <span class="code-snippet">h6</span> para crear esa estructura.</p>

                    <div class="concept-card">
                        <div class="concept-title"><i data-lucide="list-ordered"></i> Reglas de Oro</div>
                        <ul class="text-sm text-slate-300 list-disc pl-4 space-y-2">
                            <li>El <strong>h1</strong> es el rey. Solo debe haber UNO por página (usualmente el título principal).</li>
                            <li>Usa <strong>h2</strong> para secciones principales.</li>
                            <li>Usa <strong>h3</strong> para subsecciones, y así sucesivamente.</li>
                            <li>Nunca uses encabezados solo para hacer el texto grande. Para eso está CSS. Úsalos para dar <strong>significado</strong>.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<h1>Noticias del Día</h1>\n\n<h2>Deportes</h2>\n<p>Ganó el equipo local...</p>\n\n<h2>Clima</h2>\n<h3>Pronóstico Semanal</h3>`,
                exercise: {
                    instruction: "Crea una jerarquía lógica: Un <h1> que diga 'Mi Blog', y debajo un <h2> que diga 'Primer Post'.",
                    placeholder: "<h1>...</h1>",
                    difficulty: "Fácil",
                    hint: "Asegúrate de cerrar las etiquetas: </h1> y </h2>.",
                    validate: (doc) => {
                        const h1 = doc.querySelector('h1');
                        const h2 = doc.querySelector('h2');
                        if(!h1) return {valid:false, msg:"Falta el título principal <h1>."};
                        if(h1.innerText !== 'Mi Blog') return {valid:false, msg:"El h1 debe decir 'Mi Blog'."};
                        if(!h2) return {valid:false, msg:"Falta el subtítulo <h2>."};
                        if(h2.innerText !== 'Primer Post') return {valid:false, msg:"El h2 debe decir 'Primer Post'."};
                        return {valid:true, msg:"¡Estructura sólida como una roca!"};
                    }
                },
                quiz: { q: "¿Cuántos <h1> se recomienda tener por página?", options: ["Tantos como quieras", "Solo uno", "Ninguno, usa h2"], correct: 1 }
            },
            {
                id: "m03",
                title: "3. Párrafos y Espacio",
                desc: "El bloque de construcción básico.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 03</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Párrafos (P)</h1>
                    
                    <p>La etiqueta <span class="code-snippet">&lt;p&gt;</span> define un bloque de texto. Es inteligente: automáticamente añade un margen arriba y abajo para separar las ideas.</p>

                    <div class="concept-card border-orange-500/30 bg-orange-500/5">
                        <div class="concept-title text-orange-400"><i data-lucide="alert-triangle"></i> ¡Cuidado con los 'Enter'!</div>
                        <p class="text-sm text-slate-300">
                            En HTML, si das 10 veces 'Enter' en tu código, el navegador lo ignorará y mostrará solo un espacio. Si quieres párrafos separados, <strong>debes</strong> usar etiquetas <span class="code-snippet">&lt;p&gt;</span> separadas.
                        </p>
                    </div>
                `,
                codeRef: `<p>Este es el primer párrafo de mi historia.</p>\n<p>Aquí comienza otra idea distinta, separada visualmente.</p>`,
                exercise: {
                    instruction: "Escribe dos párrafos distintos. El primero debe decir 'Hola' y el segundo 'Mundo'. Nota cómo se separan solos.",
                    placeholder: "<p>...</p>",
                    difficulty: "Fácil",
                    hint: "Necesitas abrir y cerrar <p> dos veces.",
                    validate: (doc) => {
                        const ps = doc.querySelectorAll('p');
                        if(ps.length < 2) return {valid:false, msg:"No seas tímido, escribe al menos 2 párrafos."};
                        if(ps[0].innerText.trim() !== 'Hola') return {valid:false, msg:"El primer párrafo debe decir 'Hola'."};
                        if(ps[1].innerText.trim() !== 'Mundo') return {valid:false, msg:"El segundo párrafo debe decir 'Mundo'."};
                        return {valid:true, msg:"¡Texto renderizado y separado!"};
                    }
                },
                quiz: { q: "¿HTML respeta los saltos de línea que haces con 'Enter'?", options: ["Sí, siempre", "No, los ignora", "Solo en el <head>"], correct: 1 }
            },
            {
                id: "m04",
                title: "4. Estilo con Significado",
                desc: "No es solo estética, es semántica.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 04</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Negritas y Cursivas</h1>
                    
                    <p>Antiguamente usábamos <code>&lt;b&gt;</code> (bold) e <code>&lt;i&gt;</code> (italic). Hoy usamos etiquetas que explican <strong>qué es</strong> el texto, no solo cómo se ve.</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="concept-card mb-0">
                            <div class="concept-title text-white">STRONG</div>
                            <p class="text-xs text-slate-400">Importancia fuerte. Los lectores de pantalla gritan esto.</p>
                            <div class="code-snippet mt-2">&lt;strong&gt;URGENTE&lt;/strong&gt;</div>
                        </div>
                        <div class="concept-card mb-0">
                            <div class="concept-title text-white">EM (Emphasis)</div>
                            <p class="text-xs text-slate-400">Énfasis sutil, como cambiar el tono de voz.</p>
                            <div class="code-snippet mt-2">&lt;em&gt;realmente&lt;/em&gt;</div>
                        </div>
                    </div>
                `,
                codeRef: `<p>Es <strong>crucial</strong> que leas esto con <em>atención</em>.</p>`,
                exercise: {
                    instruction: "Crea un párrafo que diga 'Alerta: ten cuidado'. La palabra 'Alerta' debe ser strong y 'cuidado' debe ser em.",
                    placeholder: "<p>...</p>",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        if(!doc.querySelector('p')) return {valid:false, msg:"Empieza con un párrafo <p>."};
                        const s = doc.querySelector('strong');
                        const e = doc.querySelector('em');
                        if(!s || s.innerText.toLowerCase() !== 'alerta') return {valid:false, msg:"Falta <strong> envolviendo 'Alerta'."};
                        if(!e || e.innerText.toLowerCase() !== 'cuidado') return {valid:false, msg:"Falta <em> envolviendo 'cuidado'."};
                        return {valid:true, msg:"¡Has dado énfasis con significado!"};
                    }
                },
                quiz: { q: "¿Por qué preferimos <strong> sobre <b>?", options: ["Se ve más negro", "Es semántico y accesible", "Es más corto de escribir"], correct: 1 }
            },
            {
                id: "m05",
                title: "5. El Portal (Links)",
                desc: "La base de la 'World Wide Web'.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 05</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Enlaces (Anchor Tags)</h1>
                    
                    <p>Sin enlaces, la web sería solo documentos aislados. La etiqueta <span class="code-snippet">&lt;a&gt;</span> (anchor) conecta el mundo.</p>

                    <div class="block-code">
                        &lt;a href="destino" target="ventana"&gt;Texto Clicable&lt;/a&gt;
                    </div>

                    <ul class="text-sm text-slate-300 list-disc pl-4 space-y-2 mb-4">
                        <li><strong>href:</strong> (Hypertext Reference) ¿A dónde vamos?</li>
                        <li><strong>target="_blank":</strong> Abre en una pestaña nueva (útil para enlaces externos).</li>
                    </ul>
                `,
                codeRef: `<a href="https://google.com" target="_blank">Ir a Google</a>`,
                exercise: {
                    instruction: "Crea un enlace a 'https://bing.com' con el texto 'Buscador'. Haz que se abra en una nueva pestaña.",
                    placeholder: "<a ...>...</a>",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const a = doc.querySelector('a');
                        if(!a) return {valid:false, msg:"No veo ningún ancla <a>."};
                        if(a.getAttribute('href') !== 'https://bing.com') return {valid:false, msg:"El destino (href) es incorrecto."};
                        if(a.getAttribute('target') !== '_blank') return {valid:false, msg:"Falta target='_blank' para nueva pestaña."};
                        if(a.innerText !== 'Buscador') return {valid:false, msg:"El texto visible debe ser 'Buscador'."};
                        return {valid:true, msg:"¡Enlace interdimensional creado!"};
                    }
                },
                quiz: { q: "¿Qué atributo define la URL de destino?", options: ["src", "link", "href"], correct: 2 }
            },
            {
                id: "m06",
                title: "6. Imágenes",
                desc: "Una imagen vale más que mil etiquetas.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 06</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Etiqueta IMG</h1>
                    <p>La etiqueta <span class="code-snippet">&lt;img&gt;</span> es especial: es una "etiqueta vacía", no tiene cierre.</p>
                    <div class="concept-card">
                        <div class="concept-title"><i data-lucide="image"></i> Atributos Obligatorios</div>
                        <ul class="text-sm text-slate-300 list-disc pl-4 space-y-2">
                            <li><strong>src:</strong> La ruta del archivo de imagen.</li>
                            <li><strong>alt:</strong> Texto alternativo. CRUCIAL para ciegos o si la imagen falla.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<img src="gato.jpg" alt="Un gato lindo durmiendo" width="300">`,
                exercise: {
                    instruction: "Inserta una imagen. Usa src='logo.png', un alt descriptivo 'Mi Logo' y un ancho (width) de '100'.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        const img = doc.querySelector('img');
                        if(!img) return {valid:false, msg:"Falta la etiqueta <img>."};
                        if(img.getAttribute('src') !== 'logo.png') return {valid:false, msg:"El src debe ser 'logo.png'."};
                        if(img.getAttribute('alt') !== 'Mi Logo') return {valid:false, msg:"No olvides el texto alternativo (alt='Mi Logo')."};
                        if(img.getAttribute('width') !== '100') return {valid:false, msg:"Controla el tamaño con width='100'."};
                        return {valid:true, msg:"¡Imagen renderizada correctamente!"};
                    }
                },
                quiz: { q: "¿La etiqueta img tiene cierre </img>?", options: ["Sí", "No, es auto-contenido", "Depende del navegador"], correct: 1 }
            },
            {
                id: "m07",
                title: "7. Listas Desordenadas",
                desc: "Bullets para organizar ideas.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 07</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Listas (UL)</h1>
                    <p>Para listas donde el orden no importa (como la compra). Usamos <span class="code-snippet">&lt;ul&gt;</span> como contenedor y <span class="code-snippet">&lt;li&gt;</span> (list item) para cada punto.</p>
                `,
                codeRef: `<ul>\n  <li>Leche</li>\n  <li>Pan</li>\n  <li>Huevos</li>\n</ul>`,
                exercise: {
                    instruction: "Crea una lista de colores con 3 ítems: 'Rojo', 'Verde', 'Azul'. Usa UL.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        const ul = doc.querySelector('ul');
                        if(!ul) return {valid:false, msg:"Falta el contenedor <ul>."};
                        const lis = ul.querySelectorAll('li');
                        if(lis.length !== 3) return {valid:false, msg:"Deben ser exactamente 3 colores."};
                        if(lis[0].innerText !== 'Rojo') return {valid:false, msg:"El primero debe ser 'Rojo'."};
                        return {valid:true, msg:"¡Lista creada con éxito!"};
                    }
                },
                quiz: { q: "¿Qué significa UL?", options: ["Underlined List", "Unordered List", "Unique List"], correct: 1 }
            },
            {
                id: "m08",
                title: "8. Listas Ordenadas",
                desc: "Paso 1, Paso 2, Paso 3...",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 08</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Listas Numeradas (OL)</h1>
                    <p>Igual que las anteriores, pero para instrucciones secuenciales. El navegador las numera automáticamente.</p>
                `,
                codeRef: `<ol>\n  <li>Batir huevos</li>\n  <li>Freír</li>\n  <li>Comer</li>\n</ol>`,
                exercise: {
                    instruction: "Crea una lista ordenada con 2 pasos: 'Abrir' y 'Cerrar'.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        const ol = doc.querySelector('ol');
                        if(!ol) return {valid:false, msg:"Usa <ol> para listas ordenadas."};
                        const lis = ol.querySelectorAll('li');
                        if(lis.length !== 2) return {valid:false, msg:"Necesitas 2 pasos."};
                        if(lis[0].innerText !== 'Abrir') return {valid:false, msg:"El paso 1 es 'Abrir'."};
                        return {valid:true, msg:"¡Secuencia lógica establecida!"};
                    }
                },
                quiz: { q: "¿Puedes cambiar los números por letras (A, B, C)?", options: ["No", "Sí, con el atributo type", "Sí, pero solo con JS"], correct: 1 }
            },
            {
                id: "m09",
                title: "9. Divs y Spans",
                desc: "Las cajas genéricas.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 09</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Contenedores Genéricos</h1>
                    <div class="grid grid-cols-1 gap-4">
                        <div class="concept-card mb-0">
                            <div class="concept-title text-white">DIV (Block)</div>
                            <p class="text-xs text-slate-400">Una caja invisible que ocupa todo el ancho. Se usa para agrupar secciones grandes.</p>
                        </div>
                        <div class="concept-card mb-0">
                            <div class="concept-title text-white">SPAN (Inline)</div>
                            <p class="text-xs text-slate-400">Una caja pequeña que solo envuelve texto sin romper la línea. Ideal para colorear una palabra.</p>
                        </div>
                    </div>
                `,
                codeRef: `<div>\n  <p>Texto normal con una <span style="color:red">palabra roja</span>.</p>\n</div>`,
                exercise: {
                    instruction: "Crea un <div>. Dentro pon un <p> que diga 'Hola <span style='color:blue'>Mundo</span>'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const div = doc.querySelector('div');
                        if(!div) return {valid:false, msg:"Falta el <div> contenedor."};
                        const p = div.querySelector('p');
                        if(!p) return {valid:false, msg:"Falta el <p> dentro del div."};
                        const span = p.querySelector('span');
                        if(!span || span.innerText !== 'Mundo') return {valid:false, msg:"Envuelve 'Mundo' en un <span>."};
                        if(span.style.color !== 'blue') return {valid:false, msg:"Ponle style='color:blue' al span."};
                        return {valid:true, msg:"¡Has dominado los contenedores!"};
                    }
                },
                quiz: { q: "¿El <span> fuerza un salto de línea?", options: ["Sí", "No, es elemento en línea", "A veces"], correct: 1 }
            },
            {
                id: "m10",
                title: "10. Class e ID",
                desc: "Identificando elementos.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 10</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Atributos Globales</h1>
                    <p>Para que CSS (estilo) o JS (funcionalidad) encuentren tus elementos, necesitas ponerles nombre.</p>
                    <ul class="text-sm text-slate-300 list-disc pl-4 space-y-2 mb-4">
                        <li><strong>id:</strong> Como un DNI. Debe ser ÚNICO en toda la página.</li>
                        <li><strong>class:</strong> Como un uniforme. Muchos elementos pueden tener la misma clase.</li>
                    </ul>
                `,
                codeRef: `<div id="encabezado-principal" class="caja oscura">\n  Contenido...\n</div>`,
                exercise: {
                    instruction: "Crea un párrafo con id='intro' y class='texto-grande'.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        const p = doc.querySelector('p');
                        if(!p) return {valid:false, msg:"Falta el <p>."};
                        if(p.id !== 'intro') return {valid:false, msg:"El id debe ser 'intro'."};
                        if(p.className !== 'texto-grande') return {valid:false, msg:"La clase debe ser 'texto-grande'."};
                        return {valid:true, msg:"¡Elementos identificados!"};
                    }
                },
                quiz: { q: "¿Pueden dos elementos tener el mismo ID?", options: ["Sí", "No, es ilegal", "Solo si son divs"], correct: 1 }
            },
            {
                id: "m11",
                title: "11. Tablas Básicas",
                desc: "Filas y Celdas.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 11</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Tablas</h1>
                    <p>Excel en HTML. Estructura: <code>table</code> > <code>tr</code> (fila) > <code>td</code> (celda de dato).</p>
                `,
                codeRef: `<table border="1">\n  <tr>\n    <td>Celda A</td>\n    <td>Celda B</td>\n  </tr>\n</table>`,
                exercise: {
                    instruction: "Crea una tabla con 1 fila (tr). Esa fila debe tener 2 celdas (td) con los textos 'A' y 'B'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const table = doc.querySelector('table');
                        if(!table) return {valid:false, msg:"Falta <table>."};
                        const tr = table.querySelector('tr');
                        if(!tr) return {valid:false, msg:"Falta la fila <tr>."};
                        const tds = tr.querySelectorAll('td');
                        if(tds.length !== 2) return {valid:false, msg:"Necesitas 2 celdas <td>."};
                        if(tds[0].innerText !== 'A' || tds[1].innerText !== 'B') return {valid:false, msg:"Los textos deben ser 'A' y 'B'."};
                        return {valid:true, msg:"¡Tabla construida!"};
                    }
                },
                quiz: { q: "¿Qué significa TR?", options: ["Table Row", "Table Record", "Table Root"], correct: 0 }
            },
            {
                id: "m12",
                title: "12. Tablas Pro",
                desc: "Organización semántica.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 12</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Anatomía de Tabla</h1>
                    <p>Usa <code>thead</code> para los encabezados y <code>tbody</code> para los datos. Ayuda a los navegadores a imprimir tablas largas.</p>
                `,
                codeRef: `<table>\n  <thead>...</thead>\n  <tbody>...</tbody>\n</table>`,
                exercise: {
                    instruction: "Estructura una tabla con un <thead> y un <tbody> dentro.",
                    placeholder: "<table>\n...",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        if(!doc.querySelector('table > thead')) return {valid:false, msg:"Falta el <thead> dentro de la tabla."};
                        if(!doc.querySelector('table > tbody')) return {valid:false, msg:"Falta el <tbody> dentro de la tabla."};
                        return {valid:true, msg:"¡Estructura de tabla profesional!"};
                    }
                },
                quiz: { q: "¿Para qué sirve rowspan?", options: ["Unir filas verticalmente", "Unir columnas", "Separar celdas"], correct: 0 }
            },
            {
                id: "m13",
                title: "13. Semántica: Cabecera",
                desc: "Header y Nav.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 13</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Layout Semántico</h1>
                    <p>Antes hacíamos <code>div id='header'</code>. Ahora usamos etiquetas reales: <code>&lt;header&gt;</code> para la cabecera y <code>&lt;nav&gt;</code> para menús.</p>
                `,
                codeRef: `<header>\n  <nav>\n    <a href="#">Inicio</a>\n  </nav>\n</header>`,
                exercise: {
                    instruction: "Crea un <header>. Dentro coloca un <nav> y dentro del nav un texto 'Menú'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const h = doc.querySelector('header');
                        if(!h) return {valid:false, msg:"Falta <header>."};
                        if(!h.querySelector('nav')) return {valid:false, msg:"El <nav> debe estar dentro del header."};
                        if(h.querySelector('nav').innerText !== 'Menú') return {valid:false, msg:"El texto 'Menú' falta."};
                        return {valid:true, msg:"¡Semántica aplicada!"};
                    }
                },
                quiz: { q: "¿El <footer> debe ir siempre al final?", options: ["Sí, obligatorio", "No, puede ir dentro de artículos", "No existe footer"], correct: 1 }
            },
            {
                id: "m14",
                title: "14. Semántica: Cuerpo",
                desc: "Main, Section, Article.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 14</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Estructura de Contenido</h1>
                    <div class="concept-card">
                        <ul class="text-sm text-slate-300 list-disc pl-4 space-y-2">
                            <li><strong>main:</strong> El contenido principal único de la página.</li>
                            <li><strong>article:</strong> Contenido que tiene sentido por sí mismo (un post de blog).</li>
                            <li><strong>section:</strong> Una agrupación temática (ej: "Sobre Mí").</li>
                        </ul>
                    </div>
                `,
                codeRef: `<main>\n  <section id="intro">\n    <h2>Hola</h2>\n  </section>\n</main>`,
                exercise: {
                    instruction: "Crea un <main> y dentro una <section> con el id='servicios'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const m = doc.querySelector('main');
                        if(!m) return {valid:false, msg:"Falta <main>."};
                        const s = m.querySelector('section');
                        if(!s) return {valid:false, msg:"Falta <section> dentro de main."};
                        if(s.id !== 'servicios') return {valid:false, msg:"El section necesita id='servicios'."};
                        return {valid:true, msg:"¡Estructura lógica!"};
                    }
                },
                quiz: { q: "¿Cuántos <main> debe haber por página?", options: ["Tantos como quieras", "Solo uno visible", "Ninguno"], correct: 1 }
            },
            {
                id: "m15",
                title: "15. Formularios",
                desc: "Interacción con el usuario.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 15</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Formularios</h1>
                    <p>La etiqueta <span class="code-snippet">&lt;input&gt;</span> es la más versátil de HTML. Sirve para escribir texto, checkboxes, fechas, etc.</p>
                `,
                codeRef: `<form>\n  <label>Nombre:</label>\n  <input type="text">\n</form>`,
                exercise: {
                    instruction: "Crea un formulario con un input de tipo 'text'.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        if(!doc.querySelector('form')) return {valid:false, msg:"Falta <form>."};
                        const i = doc.querySelector('input');
                        if(!i || i.type !== 'text') return {valid:false, msg:"Falta <input type='text'>."};
                        return {valid:true, msg:"¡Formulario iniciado!"};
                    }
                },
                quiz: { q: "¿Input necesita etiqueta de cierre </input>?", options: ["Sí", "No", "A veces"], correct: 1 }
            },
            {
                id: "m16",
                title: "16. Tipos de Input",
                desc: "Validación automática.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 16</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Inputs Inteligentes</h1>
                    <p>Si usas el tipo correcto, los móviles mostrarán el teclado correcto (ej: teclado numérico para <code>number</code>).</p>
                    <div class="block-code">type="email", type="password", type="date", type="color"</div>
                `,
                codeRef: `<input type="email" placeholder="tu@email.com">`,
                exercise: {
                    instruction: "Crea un input para contraseña con placeholder='Secreto'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const i = doc.querySelector('input');
                        if(!i || i.type !== 'password') return {valid:false, msg:"El tipo debe ser 'password'."};
                        if(i.getAttribute('placeholder') !== 'Secreto') return {valid:false, msg:"El placeholder debe ser 'Secreto'."};
                        return {valid:true, msg:"¡Campo seguro creado!"};
                    }
                },
                quiz: { q: "¿Qué hace type='email' en móviles?", options: ["Nada", "Muestra @ en el teclado", "Envía el email solo"], correct: 1 }
            },
            {
                id: "m17",
                title: "17. Select & Textarea",
                desc: "Más allá del input simple.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 17</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Otros Controles</h1>
                    <p><code>select</code> crea menús desplegables (con <code>option</code> dentro). <code>textarea</code> es para textos largos (comentarios).</p>
                `,
                codeRef: `<select>\n  <option>Opción A</option>\n</select>\n<textarea></textarea>`,
                exercise: {
                    instruction: "Crea un <select> con dos opciones: 'Si' y 'No'.",
                    difficulty: "Intermedio",
                    validate: (doc) => {
                        const s = doc.querySelector('select');
                        if(!s) return {valid:false, msg:"Falta el <select>."};
                        const ops = s.querySelectorAll('option');
                        if(ops.length !== 2) return {valid:false, msg:"Necesitas 2 opciones."};
                        if(ops[0].innerText !== 'Si') return {valid:false, msg:"Opción 1 debe ser 'Si'."};
                        return {valid:true, msg:"¡Menú desplegable listo!"};
                    }
                },
                quiz: { q: "¿Textarea es de cierre automático?", options: ["Sí", "No, requiere </textarea>", "No importa"], correct: 1 }
            },
            {
                id: "m18",
                title: "18. Botones",
                desc: "¡Acción!",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 18</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Buttons</h1>
                    <p>Dentro de un form, <code>type="submit"</code> envía los datos. Fuera, <code>type="button"</code> no hace nada hasta que usas JavaScript.</p>
                `,
                codeRef: `<button type="submit">Enviar Datos</button>`,
                exercise: {
                    instruction: "Crea un botón de tipo 'submit' que diga 'Guardar'.",
                    difficulty: "Fácil",
                    validate: (doc) => {
                        const b = doc.querySelector('button');
                        if(!b) return {valid:false, msg:"Falta el <button>."};
                        if(b.getAttribute('type') !== 'submit') return {valid:false, msg:"Tipo debe ser 'submit'."};
                        if(b.innerText !== 'Guardar') return {valid:false, msg:"Texto debe ser 'Guardar'."};
                        return {valid:true, msg:"¡Botón listo!"};
                    }
                },
                quiz: { q: "¿Cuál es el tipo por defecto de un botón en un form?", options: ["button", "reset", "submit"], correct: 2 }
            },
            {
                id: "m19",
                title: "19. Iframes",
                desc: "Ventanas a otros mundos.",
                content: `
                    <div class="mb-4"><span class="badge-mod">Módulo 19</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Contenido Incrustado</h1>
                    <p>Los iframes permiten mostrar otra página web dentro de la tuya (como un video de YouTube o un Mapa).</p>
                `,
                codeRef: `<iframe src="https://wikipedia.org" height="400"></iframe>`,
                exercise: {
                    instruction: "Inserta un iframe vacío (src='about:blank') con borde 0 (frameborder='0').",
                    difficulty: "Avanzado",
                    validate: (doc) => {
                        const i = doc.querySelector('iframe');
                        if(!i) return {valid:false, msg:"Falta <iframe>."};
                        if(i.getAttribute('src') !== 'about:blank') return {valid:false, msg:"Src debe ser 'about:blank'."};
                        if(i.getAttribute('frameborder') !== '0') return {valid:false, msg:"Frameborder debe ser '0'."};
                        return {valid:true, msg:"¡Ventana incrustada!"};
                    }
                },
                quiz: { q: "¿Son peligrosos los iframes?", options: ["No, nunca", "Pueden ser un riesgo de seguridad", "Solo si son de Google"], correct: 1 }
            },
            {
                id: "m20",
                title: "20. Proyecto Final",
                desc: "Demuestra lo que vales.",
                content: `
                    <div class="mb-4"><span class="badge-mod bg-orange-600 text-white animate-pulse">Desafío Final</span></div>
                    <h1 class="text-3xl font-bold text-white mb-6">Tu Perfil de Desarrollador</h1>
                    <p class="mb-4">Es hora de combinar todo: Estructura, Imágenes, Listas y Formularios.</p>
                    
                    <div class="concept-card">
                        <div class="concept-title">Requisitos del Examen</div>
                        <ul class="list-disc pl-4 space-y-2 text-sm text-slate-300">
                            <li>Un <strong>h1</strong> con tu nombre.</li>
                            <li>Una <strong>img</strong> (cualquier src funciona).</li>
                            <li>Una lista <strong>ul</strong> con al menos 2 habilidades.</li>
                            <li>Un <strong>form</strong> con un botón de envío.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<!-- Ejemplo Mínimo -->\n<h1>Dev</h1>\n<img src="yo.jpg">\n<ul><li>HTML</li></ul>\n<form><button>Hi</button></form>`,
                exercise: {
                    instruction: "Construye el perfil completo cumpliendo los 4 requisitos.",
                    placeholder: "<!-- Tu obra maestra aquí -->",
                    difficulty: "Experto",
                    validate: (doc) => {
                        if(!doc.querySelector('h1')) return {valid:false, msg:"Falta el título h1."};
                        if(!doc.querySelector('img')) return {valid:false, msg:"Falta tu foto (img)."};
                        if(doc.querySelectorAll('ul li').length < 2) return {valid:false, msg:"La lista necesita al menos 2 habilidades."};
                        if(!doc.querySelector('form button')) return {valid:false, msg:"Falta el formulario con botón."};
                        return {valid:true, msg:"¡ERES UN MAESTRO DE HTML5!"};
                    }
                },
                quiz: { q: "¿Estás listo para aprender CSS?", options: ["¡SÍ!", "Claro que sí", "Por supuesto"], correct: 0 }
            }
        ];

        // --- 2. GLOSARIO DATA ---
        const glossaryData = [
            { tag: "<html>", desc: "Raíz del documento." },
            { tag: "<head>", desc: "Metadatos e información invisible." },
            { tag: "<body>", desc: "Contenido visible." },
            { tag: "<h1> - <h6>", desc: "Encabezados por importancia." },
            { tag: "<p>", desc: "Párrafo de texto." },
            { tag: "<a>", desc: "Enlace (Hyperlink)." },
            { tag: "<img>", desc: "Imagen." },
            { tag: "<ul> / <ol>", desc: "Listas (Desordenada / Ordenada)." },
            { tag: "<li>", desc: "Elemento de lista." },
            { tag: "<div>", desc: "Contenedor de bloque genérico." },
            { tag: "<span>", desc: "Contenedor en línea genérico." },
            { tag: "<form>", desc: "Formulario." },
            { tag: "<input>", desc: "Campo de entrada de datos." },
            { tag: "<button>", desc: "Botón clicable." }
        ];

        // --- 3. ESTADO Y LÓGICA ---
        const STORAGE_KEY = 'godsplan_html5_v3_data';
        let state = {
            currentIdx: 0,
            completed: [],
            xp: 0
        };

        const ranks = ["Novato", "Aprendiz", "Junior", "Desarrollador", "Arquitecto", "Dios del Código"];

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            loadState();
            renderSidebar();
            loadLesson(state.currentIdx);
            updateUI();
            lucide.createIcons();
            renderGlossary();
            
            // Textarea Tab support
            document.getElementById('code-input').addEventListener('keydown', function(e) {
                if(e.key == 'Tab') {
                    e.preventDefault();
                    var start = this.selectionStart;
                    var end = this.selectionEnd;
                    this.value = this.value.substring(0, start) + "\t" + this.value.substring(end);
                    this.selectionStart = this.selectionEnd = start + 1;
                }
            });
        });

        function loadState() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if(saved) {
                try { 
                    state = JSON.parse(saved); 
                    if(state.currentIdx >= curriculum.length) state.currentIdx = curriculum.length - 1;
                } catch(e) { console.error(e); }
            }
        }

        function saveState() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
            updateUI();
        }

        function updateUI() {
            // XP & Rank
            const rankIdx = Math.min(Math.floor(state.xp / 400), ranks.length - 1);
            document.getElementById('user-rank').innerText = ranks[rankIdx];
            document.getElementById('user-xp').innerText = state.xp + " XP";

            // Progress Bar
            const pct = Math.round((state.completed.length / curriculum.length) * 100);
            document.getElementById('progress-bar').style.width = `${pct}%`;
            document.getElementById('progress-text').innerText = `${pct}%`;

            // Nav Buttons
            const btnNext = document.getElementById('btn-next');
            const isCompleted = state.completed.includes(state.currentIdx);
            
            document.getElementById('btn-prev').disabled = state.currentIdx === 0;
            
            if(isCompleted) {
                btnNext.disabled = false;
                btnNext.classList.add('bg-orange-600', 'border-orange-500', 'hover:bg-orange-500');
                btnNext.classList.remove('bg-slate-800');
            } else {
                btnNext.disabled = true;
                btnNext.classList.remove('bg-orange-600', 'border-orange-500', 'hover:bg-orange-500');
                btnNext.classList.add('bg-slate-800');
            }

            renderSidebar();
        }

        function renderSidebar() {
            const list = document.getElementById('module-list');
            list.innerHTML = curriculum.map((mod, i) => {
                const done = state.completed.includes(i);
                const active = i === state.currentIdx;
                const activeClass = active ? 'active bg-slate-800/50' : 'text-slate-400 hover:text-slate-200 hover:bg-slate-800/30 border-transparent';
                const statusIcon = done 
                    ? `<i data-lucide="check-circle" class="w-4 h-4 text-green-500"></i>` 
                    : `<span class="text-[10px] font-mono w-4 text-center opacity-50">${i+1}</span>`;

                return `
                <button onclick="loadLesson(${i})" class="nav-item w-full text-left px-3 py-2.5 rounded-md mb-1 flex items-center gap-3 text-sm font-medium transition-all border-l-[3px] group ${activeClass}">
                    ${statusIcon}
                    <div class="flex-1 truncate">
                        <span class="${active ? 'text-white' : ''}">${mod.title}</span>
                    </div>
                    ${active ? '<i data-lucide="chevron-right" class="w-3 h-3 text-orange-500"></i>' : ''}
                </button>
                `;
            }).join('');
            lucide.createIcons();
        }

        function renderGlossary() {
            const container = document.getElementById('glossary-content');
            container.innerHTML = glossaryData.map(item => `
                <div class="p-3 bg-slate-800/50 rounded border border-slate-700">
                    <code class="text-orange-400 font-bold">${item.tag.replace('<', '&lt;').replace('>', '&gt;')}</code>
                    <p class="text-sm text-slate-400 mt-1">${item.desc}</p>
                </div>
            `).join('');
        }

        function toggleGlossary() {
            const modal = document.getElementById('glossary-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
        }

        function loadLesson(idx) {
            state.currentIdx = idx;
            saveState();
            
            const mod = curriculum[idx];
            
            // Reset Areas
            document.getElementById('lesson-content').innerHTML = mod.content;
            document.getElementById('reference-code').innerText = mod.codeRef;
            document.getElementById('exercise-instruction').innerText = mod.exercise.instruction;
            document.getElementById('difficulty-badge').innerText = mod.exercise.difficulty;
            
            // Editor
            const editor = document.getElementById('code-input');
            editor.value = "";
            editor.placeholder = mod.exercise.placeholder || "<!-- Escribe tu código aquí -->";
            
            // UI Resets
            document.getElementById('workspace-area').classList.remove('hidden');
            document.getElementById('feedback-msg').style.opacity = '0';
            document.getElementById('feedback-msg').className = ""; 
            document.getElementById('btn-help').classList.toggle('hidden', !mod.exercise.hint);
            document.getElementById('quiz-container').classList.add('hidden');
            
            // Preview clear
            updatePreview("");
            
            // Scroll top
            document.getElementById('scroll-container').scrollTop = 0;
            
            // Mobile menu close
            if(window.innerWidth < 1024) {
                document.getElementById('sidebar').classList.add('-translate-x-full');
                document.getElementById('mobile-overlay').classList.remove('opacity-100', 'pointer-events-auto');
            }
            lucide.createIcons();
        }

        function updatePreview(code) {
            const frame = document.getElementById('preview-frame');
            const doc = frame.contentDocument || frame.contentWindow.document;
            doc.open();
            doc.write(`
                <style>
                    body { font-family: sans-serif; padding: 10px; color: #1e293b; }
                    h1 { color: #ea580c; border-bottom: 1px solid #fed7aa; padding-bottom: 5px; }
                    h2 { color: #475569; }
                    table { border-collapse: collapse; width: 100%; margin: 10px 0; }
                    td, th { border: 1px solid #cbd5e1; padding: 6px 10px; text-align: left; }
                    th { background: #f1f5f9; }
                    input, select, textarea { border: 1px solid #94a3b8; padding: 6px; border-radius: 4px; display:block; margin: 5px 0; width: 100%; max-width: 300px; }
                    button { background: #f97316; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 10px; }
                    button:hover { background: #ea580c; }
                    ul, ol { padding-left: 20px; }
                    li { margin-bottom: 4px; }
                    a { color: #2563eb; text-decoration: none; }
                    a:hover { text-decoration: underline; }
                    img { max-width: 100%; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                </style>
                ${code}
            `);
            doc.close();
        }

        function validateCode() {
            const mod = curriculum[state.currentIdx];
            const code = document.getElementById('code-input').value;
            const fb = document.getElementById('feedback-msg');
            
            updatePreview(code);
            
            const parser = new DOMParser();
            const doc = parser.parseFromString(code, "text/html");
            const result = mod.exercise.validate(doc, code);
            
            fb.innerText = result.msg;
            fb.style.opacity = '1';
            
            if(result.valid) {
                // Success
                fb.className = "text-xs font-bold px-4 py-2 rounded bg-green-500/10 text-green-400 border border-green-500/20 flex items-center gap-2 w-full sm:w-auto animate-[pulse-glow_1s]";
                fb.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i> ${result.msg}`;
                
                showQuiz(mod.quiz);
                lucide.createIcons();
                confetti({ particleCount: 50, spread: 60, origin: { y: 0.7 } });
            } else {
                // Error
                fb.className = "text-xs font-bold px-4 py-2 rounded bg-red-500/10 text-red-400 border border-red-500/20 flex items-center gap-2 w-full sm:w-auto animate-shake";
                fb.innerHTML = `<i data-lucide="alert-triangle" class="w-4 h-4"></i> ${result.msg}`;
                lucide.createIcons();
            }
        }

        function showQuiz(quiz) {
            const container = document.getElementById('quiz-container');
            container.classList.remove('hidden');
            
            document.getElementById('quiz-question').innerText = quiz.q;
            
            const isDone = state.completed.includes(state.currentIdx);
            
            document.getElementById('quiz-options').innerHTML = quiz.options.map((opt, i) => {
                let colorClass = "bg-slate-800 text-slate-300 hover:bg-slate-700 hover:text-white border-slate-700";
                if(isDone) {
                    if(i === quiz.correct) colorClass = "bg-green-500/20 border-green-500 text-green-400";
                    else colorClass = "bg-slate-800/50 text-slate-500 border-slate-800 opacity-50";
                }
                
                return `
                <button onclick="checkQuiz(this, ${i}, ${quiz.correct})" ${isDone ? 'disabled' : ''} 
                    class="w-full text-left p-3 rounded-lg text-sm border transition-all flex justify-between items-center ${colorClass}">
                    ${opt}
                    ${isDone && i === quiz.correct ? '<i data-lucide="check" class="w-4 h-4"></i>' : ''}
                </button>
                `;
            }).join('');
            
            lucide.createIcons();
            
            setTimeout(() => {
                container.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function checkQuiz(btn, selected, correct) {
            if(selected === correct) {
                if(!state.completed.includes(state.currentIdx)) {
                    state.completed.push(state.currentIdx);
                    state.xp += 100;
                    
                    confetti({ particleCount: 150, spread: 100 });
                    
                    if(state.completed.length === curriculum.length) {
                        setTimeout(showCertificate, 1500);
                    }
                }
                saveState();
                showQuiz(curriculum[state.currentIdx].quiz); 
            } else {
                btn.classList.add('bg-red-500/20', 'border-red-500', 'text-red-400', 'animate-shake');
            }
        }

        function showHint() {
            const hint = curriculum[state.currentIdx].exercise.hint;
            if(hint) alert("PISTA: " + hint);
        }

        function nextLesson() {
            if(state.currentIdx < curriculum.length - 1) {
                loadLesson(state.currentIdx + 1);
            }
        }

        function prevLesson() {
            if(state.currentIdx > 0) {
                loadLesson(state.currentIdx - 1);
            }
        }
        
        function resetCode() {
            document.getElementById('code-input').value = "";
            document.getElementById('code-input').focus();
        }

        function resetProgress() {
            if(confirm("¿Estás seguro? Perderás todo tu XP y avance.")) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        function toggleSidebar() {
            const sb = document.getElementById('sidebar');
            const ov = document.getElementById('mobile-overlay');
            const isClosed = sb.classList.contains('-translate-x-full');
            
            if(isClosed) {
                sb.classList.remove('-translate-x-full');
                ov.classList.add('opacity-100', 'pointer-events-auto');
            } else {
                sb.classList.add('-translate-x-full');
                ov.classList.remove('opacity-100', 'pointer-events-auto');
            }
        }
        
        // --- CERTIFICATE SYSTEM ---
        function showCertificate() {
            const modal = document.getElementById('certificate-modal');
            const content = document.getElementById('cert-content');
            
            const name = prompt("¡FELICIDADES! Has completado el curso. Ingresa tu nombre para el certificado:", "Tu Nombre");
            document.getElementById('cert-name').innerText = name || "Estudiante Anónimo";
            
            const today = new Date();
            document.getElementById('cert-date').innerText = today.toLocaleDateString('es-ES');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 50);
            
            var end = Date.now() + 3000;
            (function frame() {
              confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
              confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
              if (Date.now() < end) requestAnimationFrame(frame);
            }());
        }
        
        function closeCertModal() {
            document.getElementById('certificate-modal').classList.add('hidden');
            document.getElementById('certificate-modal').classList.remove('flex');
        }

    </script>
    
    <!-- Styles helper classes injected dynamically -->
    <style>
        .badge-mod {
            display: inline-block;
            padding: 4px 8px;
            background: rgba(249, 115, 22, 0.1);
            color: #fb923c;
            border: 1px solid rgba(249, 115, 22, 0.2);
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        /* Modal Animation */
        @keyframes modal-in {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</body>
</html>
