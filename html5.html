<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML5: Master Class Pro | Curso Interactivo</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Iconos Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            900: '#0c4a6e',
                        },
                        dark: {
                            bg: '#0f172a', 
                            surface: '#1e293b', 
                            border: '#334155', 
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 3s infinite',
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap');
        
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .font-mono { font-family: 'Fira Code', monospace; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Syntax Highlight Basics */
        .token-tag { color: #f472b6; } 
        .token-attr { color: #60a5fa; }
        .token-val { color: #a3e635; } 
        .token-comment { color: #64748b; font-style: italic; }
        .token-punct { color: #94a3b8; }
        .token-js { color: #fbbf24; }

        .code-editor-area {
            background-image: radial-gradient(#334155 1px, transparent 1px);
            background-size: 20px 20px;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        .nav-item.active {
            background: linear-gradient(to right, rgba(14, 165, 233, 0.1), transparent);
            border-left: 3px solid #0ea5e9;
            color: #38bdf8;
        }
        
        textarea:focus { outline: none; }

        /* Mobile Overlay */
        #mobile-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Didactic Box Styles */
        .concept-box {
            background: rgba(30, 41, 59, 0.5);
            border-left: 4px solid #0ea5e9;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0 0.5rem 0.5rem 0;
        }
        .example-tag {
            background: rgba(244, 114, 182, 0.1);
            color: #f472b6;
            padding: 0.1rem 0.3rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="h-16 border-b border-dark-border bg-dark-bg/80 backdrop-blur-md flex items-center justify-between px-4 md:px-6 z-50 shrink-0">
        <div class="flex items-center gap-3">
            <!-- Mobile Menu Trigger -->
            <button onclick="toggleSidebar()" class="md:hidden p-2 text-slate-400 hover:text-white">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
            
            <div class="bg-gradient-to-tr from-brand-600 to-indigo-600 p-2 rounded-lg shadow-lg shadow-brand-500/20 hidden md:block">
                <i data-lucide="layers" class="text-white w-5 h-5"></i>
            </div>
            <div>
                <h1 class="font-bold text-white tracking-tight leading-tight flex items-center gap-2">
                    Master HTML5 <span class="text-[10px] bg-brand-900 text-brand-400 px-1.5 py-0.5 rounded border border-brand-500/30">PRO</span>
                </h1>
                <p class="text-[10px] text-slate-400 font-medium uppercase tracking-wider hidden md:block">Edición Didáctica</p>
            </div>
        </div>

        <div class="flex items-center gap-6">
            <div class="flex flex-col items-end">
                <div class="flex items-center gap-2 text-xs font-semibold uppercase text-slate-400 mb-1.5">
                    <span>Progreso</span>
                    <span id="progress-text" class="text-brand-500">0%</span>
                </div>
                <div class="w-24 md:w-32 h-1.5 bg-slate-800 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-brand-500 w-0 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(14,165,233,0.5)]"></div>
                </div>
            </div>
            <!-- Reset Button -->
            <button onclick="resetProgress()" title="Reiniciar Curso" class="text-slate-500 hover:text-red-400 transition-colors">
                <i data-lucide="rotate-ccw" class="w-4 h-4"></i>
            </button>
        </div>
    </header>

    <!-- Layout Principal -->
    <div class="flex-1 flex overflow-hidden relative">
        
        <!-- Mobile Overlay -->
        <div id="mobile-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/60 z-30 opacity-0 pointer-events-none transition-opacity duration-300 md:hidden backdrop-blur-sm"></div>

        <!-- Sidebar -->
        <aside class="w-72 bg-dark-bg border-r border-dark-border flex flex-col shrink-0 transition-transform duration-300 absolute md:relative z-40 h-full -translate-x-full md:translate-x-0 shadow-2xl md:shadow-none" id="sidebar">
            <div class="p-4 border-b border-dark-border bg-dark-surface/30 flex justify-between items-center">
                <h2 class="text-xs font-bold text-slate-500 uppercase tracking-widest">Índice del Curso</h2>
                <button onclick="toggleSidebar()" class="md:hidden text-slate-400"><i data-lucide="x" class="w-4 h-4"></i></button>
            </div>
            <nav id="module-list" class="flex-1 overflow-y-auto py-2 space-y-0.5 custom-scrollbar">
                <!-- Se llena con JS -->
            </nav>
            
            <!-- User Profile footer -->
            <div class="p-4 border-t border-dark-border mt-auto bg-[#0b1120]">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-xs font-bold text-white shadow-lg">
                        JS
                    </div>
                    <div>
                        <div class="text-sm font-medium text-white">Estudiante</div>
                        <div class="text-xs text-slate-500">Nivel Principiante</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 flex flex-col lg:flex-row min-w-0 bg-dark-bg relative">
            
            <!-- Left: Theory & Exercise -->
            <section class="flex-1 overflow-y-auto scroll-smooth custom-scrollbar relative" id="scroll-container">
                <div class="max-w-3xl mx-auto p-6 lg:p-12 pb-32">
                    
                    <!-- Content Injection -->
                    <div id="lesson-content" class="animate-fade-in mb-12"></div>

                    <!-- Interactive Workspace -->
                    <div id="workspace-area" class="hidden animate-fade-in space-y-8">
                        
                        <!-- Exercise Card -->
                        <div class="rounded-xl overflow-hidden border border-brand-500/30 shadow-2xl shadow-brand-900/20 bg-[#162032]">
                            <!-- Toolbar -->
                            <div class="bg-[#1e293b] px-4 py-3 flex justify-between items-center border-b border-slate-700">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="code-2" class="w-4 h-4 text-brand-400"></i>
                                    <span class="text-xs font-bold text-slate-300 uppercase tracking-wider">Editor de Desafíos</span>
                                </div>
                                <span id="difficulty-badge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-slate-700 text-slate-300 uppercase border border-slate-600">
                                    Básico
                                </span>
                            </div>

                            <!-- Instructions -->
                            <div class="bg-gradient-to-b from-[#1e293b] to-[#162032] p-5 border-b border-slate-800">
                                <h3 class="text-white font-semibold mb-2 flex items-center gap-2">
                                    <i data-lucide="terminal" class="w-4 h-4 text-yellow-500"></i>
                                    Tu Misión:
                                </h3>
                                <p id="exercise-instruction" class="text-slate-300 text-sm leading-relaxed"></p>
                            </div>

                            <!-- Code Input with Tab Support -->
                            <div class="relative code-editor-area group">
                                <div class="absolute top-3 right-3 text-[10px] text-slate-500 font-mono pointer-events-none bg-slate-900/50 px-2 py-1 rounded">HTML/JS</div>
                                <textarea id="code-input" spellcheck="false" 
                                    class="w-full h-48 bg-transparent p-5 font-mono text-sm text-slate-200 resize-y border-none focus:ring-0 leading-relaxed tab-size-4"
                                    placeholder="<!-- Escribe tu código aquí... -->"></textarea>
                            </div>

                            <!-- Action Bar -->
                            <div class="p-4 bg-[#1e293b] border-t border-slate-700 flex flex-col sm:flex-row justify-between items-center gap-4">
                                <div id="feedback-msg" class="w-full sm:w-auto text-xs font-medium px-3 py-1.5 rounded transition-all opacity-0 text-center sm:text-left"></div>
                                <button onclick="validateCode()" class="w-full sm:w-auto group relative px-5 py-2 bg-brand-600 hover:bg-brand-500 text-white text-sm font-semibold rounded-lg shadow-lg shadow-brand-600/20 transition-all flex items-center justify-center gap-2 overflow-hidden">
                                    <div class="absolute inset-0 w-full h-full bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                                    <span class="relative z-10 flex items-center gap-2">
                                        <i data-lucide="play" class="w-4 h-4 fill-current"></i> Verificar Código
                                    </span>
                                </button>
                            </div>
                        </div>

                        <!-- Quiz Section (Hidden initially) -->
                        <div id="quiz-container" class="hidden bg-slate-800/50 border border-slate-700 rounded-xl p-6 backdrop-blur-sm relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"></div>
                            <div class="flex items-start gap-4 relative z-10">
                                <div class="w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center shrink-0 text-purple-400 border border-purple-500/20">
                                    <i data-lucide="help-circle" class="w-6 h-6"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-lg font-bold text-white mb-2">Pregunta Rápida</h3>
                                    <p id="quiz-question" class="text-slate-300 mb-4 text-sm"></p>
                                    <div id="quiz-options" class="space-y-2"></div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Navigation -->
                    <div class="mt-12 flex justify-between items-center pt-8 border-t border-slate-800">
                        <button onclick="prevLesson()" id="btn-prev" class="px-4 py-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors flex items-center gap-2 text-sm font-medium disabled:opacity-30 disabled:pointer-events-none">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i> Anterior
                        </button>
                        <button onclick="nextLesson()" id="btn-next" class="px-6 py-2.5 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-all flex items-center gap-2 text-sm font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            Siguiente <i data-lucide="arrow-right" class="w-4 h-4"></i>
                        </button>
                    </div>

                </div>
            </section>

            <!-- Right: Live Preview & Code Reference -->
            <section class="hidden lg:flex w-[45%] xl:w-[40%] flex-col border-l border-dark-border bg-[#0b1120] relative z-10">
                
                <!-- Tab Header -->
                <div class="h-10 bg-dark-bg border-b border-dark-border flex items-end px-2 gap-1">
                    <div class="px-4 py-2 bg-[#1e293b] text-blue-400 text-xs font-mono border-t-2 border-blue-500 rounded-t-md flex items-center gap-2">
                        <i data-lucide="file-code" class="w-3 h-3"></i> index.html
                    </div>
                    <div class="ml-auto flex items-center px-3 py-2 gap-2">
                        <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Live Preview</span>
                    </div>
                </div>

                <!-- Read-only Code View -->
                <div class="h-1/2 overflow-hidden bg-[#1e293b] border-b-4 border-dark-bg flex flex-col">
                    <div class="flex justify-between items-center px-4 py-2 border-b border-slate-700/50 bg-[#1e293b]">
                        <span class="text-[10px] text-slate-500 font-bold uppercase">Ejemplo de Referencia</span>
                    </div>
                    <pre id="reference-code" class="flex-1 p-5 font-mono text-xs md:text-sm text-slate-300 overflow-auto custom-scrollbar select-text"></pre>
                </div>

                <!-- Browser Preview -->
                <div class="h-1/2 flex flex-col bg-white">
                    <div class="h-8 bg-slate-100 border-b border-slate-200 flex items-center px-3 gap-2 shrink-0">
                        <div class="flex gap-1.5">
                            <div class="w-2.5 h-2.5 rounded-full bg-red-400"></div>
                            <div class="w-2.5 h-2.5 rounded-full bg-yellow-400"></div>
                            <div class="w-2.5 h-2.5 rounded-full bg-green-400"></div>
                        </div>
                        <div class="flex-1 bg-white h-5 rounded border border-slate-200 flex items-center px-2 shadow-sm">
                            <i data-lucide="lock" class="w-2.5 h-2.5 text-slate-400 mr-1.5"></i>
                            <span class="text-[9px] text-slate-400 font-sans">localhost:8080/preview</span>
                        </div>
                    </div>
                    <iframe id="preview-frame" class="flex-1 w-full border-none bg-white"></iframe>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal de Completado (Reemplaza al Alert) -->
    <div id="completion-modal" class="fixed inset-0 z-[60] hidden items-center justify-center">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm"></div>
        <div class="bg-[#1e293b] border border-slate-700 p-8 rounded-2xl shadow-2xl relative z-10 max-w-sm w-full mx-4 text-center transform scale-95 opacity-0 transition-all duration-300" id="modal-content">
            <div class="w-16 h-16 bg-gradient-to-tr from-yellow-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg shadow-orange-500/30">
                <i data-lucide="trophy" class="w-8 h-8 text-white"></i>
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">¡Curso Completado!</h2>
            <p class="text-slate-400 text-sm mb-6">Has dominado los conceptos esenciales de HTML5 y sus APIs modernas.</p>
            <button onclick="closeModal()" class="w-full py-2.5 bg-brand-600 hover:bg-brand-500 text-white font-semibold rounded-lg shadow-lg shadow-brand-500/20 transition-all">
                ¡Genial!
            </button>
        </div>
    </div>

    <!-- Data & Logic -->
    <script>
        // -------------------------------------------------------------------
        // 1. CONFIGURACIÓN Y ESTADO (PERSISTENCIA AGREGADA)
        // -------------------------------------------------------------------
        
        const STORAGE_KEY = 'html5_masterclass_progress';
        
        // Estado inicial
        let state = {
            currentIndex: 0,
            progress: 0,
            completedLessons: [] // Array de IDs
        };

        // CONTENIDO DIDÁCTICO REESCRITO PARA PRINCIPIANTES
        const curriculum = [
            {
                id: "intro",
                title: "1. ¿Qué es HTML?",
                icon: "layout",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 1</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">El Esqueleto de la Web</h1>
                    
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <div class="concept-box">
                            <h3 class="text-white font-bold mb-2">Concepto: Etiquetas (Tags)</h3>
                            <p class="text-sm">Imagina que HTML es como Lego. Usas piezas llamadas <strong>etiquetas</strong> para construir cosas. Las etiquetas casi siempre vienen en pares: una que abre <code class="example-tag">&lt;p&gt;</code> y otra que cierra <code class="example-tag">&lt;/p&gt;</code>.</p>
                        </div>

                        <p class="mb-4">Todo documento HTML5 necesita una estructura básica, como un cuerpo humano:</p>
                        
                        <ul class="list-none space-y-4 text-sm mb-6">
                            <li class="flex gap-3">
                                <div class="w-8 h-8 rounded bg-slate-800 flex items-center justify-center shrink-0 font-bold text-brand-400">1</div>
                                <div>
                                    <strong class="text-white">DOCTYPE:</strong> 
                                    <code class="example-tag">&lt;!DOCTYPE html&gt;</code>
                                    <p class="text-slate-400 mt-1">Le dice al navegador: "Oye, esto es HTML moderno". Va siempre al principio.</p>
                                </div>
                            </li>
                            <li class="flex gap-3">
                                <div class="w-8 h-8 rounded bg-slate-800 flex items-center justify-center shrink-0 font-bold text-brand-400">2</div>
                                <div>
                                    <strong class="text-white">HTML:</strong> 
                                    <code class="example-tag">&lt;html lang="es"&gt;</code>
                                    <p class="text-slate-400 mt-1">Es la caja grande que contiene TODO. El atributo <code>lang="es"</code> dice que la página está en español.</p>
                                </div>
                            </li>
                            <li class="flex gap-3">
                                <div class="w-8 h-8 rounded bg-slate-800 flex items-center justify-center shrink-0 font-bold text-brand-400">3</div>
                                <div>
                                    <strong class="text-white">HEAD y BODY:</strong> 
                                    <p class="text-slate-400 mt-1"><code class="example-tag">&lt;head&gt;</code> es el cerebro (configuración, título) y <code class="example-tag">&lt;body&gt;</code> es el cuerpo visible (texto, imágenes).</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                `,
                codeRef: `<!DOCTYPE html>
<!-- Inicio del documento -->
<html lang="es">
  <!-- Cerebro: Configuración -->
  <head>
    <meta charset="utf-8">
    <title>Mi Primera Web</title>
  </head>
  
  <!-- Cuerpo: Lo que se ve -->
  <body>
    <h1>¡Hola Mundo!</h1>
    <p>Esto es HTML.</p>
  </body>
</html>`,
                exercise: {
                    instruction: "Vamos a crear el esqueleto. Escribe la estructura básica: el DOCTYPE, la etiqueta html con lang='es' y un título dentro del head.",
                    placeholder: "<!DOCTYPE html>\n<html>\n...",
                    difficulty: "Básico",
                    validate: (code) => {
                        const clean = code.toLowerCase().replace(/\s+/g, '');
                        if (!clean.includes('<!doctypehtml>')) return { valid: false, msg: "Falta la declaración <!DOCTYPE html> al principio." };
                        if (!clean.includes('<htmllang="es">') && !clean.includes("<htmllang='es'>")) return { valid: false, msg: "La etiqueta html debe tener lang='es'." };
                        if (!clean.includes('<title>')) return { valid: false, msg: "Añade un <title> dentro de <head>." };
                        return { valid: true, msg: "¡Perfecto! Ya tienes la base." };
                    }
                },
                quiz: {
                    q: "¿Qué parte del HTML contiene lo que el usuario ve en la pantalla?",
                    options: ["<head>", "<body>", "<doctype>"],
                    correct: 1
                }
            },
            {
                id: "semantics",
                title: "2. Organizar con Sentido",
                icon: "columns",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 2</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Cajas con Etiqueta</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <div class="concept-box">
                            <h3 class="text-white font-bold mb-2">Problema: El exceso de DIVs</h3>
                            <p class="text-sm">Antes, usábamos <code class="example-tag">&lt;div&gt;</code> para todo. Era como tener 100 cajas de mudanza marrones sin escribir qué había dentro. Un caos.</p>
                        </div>

                        <p>HTML5 introdujo <strong>Etiquetas Semánticas</strong>. Son cajas con nombre propio que explican qué contienen:</p>
                        
                        <div class="grid grid-cols-1 gap-3 my-6 text-sm">
                            <div class="bg-slate-800 p-3 rounded border-l-4 border-pink-500">
                                <code class="text-pink-400 font-bold text-lg">&lt;header&gt;</code>
                                <p class="text-slate-300">La parte superior. Suele tener el logo y el menú.</p>
                            </div>
                            <div class="bg-slate-800 p-3 rounded border-l-4 border-purple-500">
                                <code class="text-purple-400 font-bold text-lg">&lt;nav&gt;</code>
                                <p class="text-slate-300">Exclusivo para la barra de navegación (links).</p>
                            </div>
                            <div class="bg-slate-800 p-3 rounded border-l-4 border-yellow-500">
                                <code class="text-yellow-400 font-bold text-lg">&lt;footer&gt;</code>
                                <p class="text-slate-300">El pie de página. Derechos de autor, contacto, etc.</p>
                            </div>
                        </div>
                    </div>
                `,
                codeRef: `<header>
    <h1>Blog de Cocina</h1>
    <!-- Navegación aquí -->
    <nav>
        <a href="#">Recetas</a>
        <a href="#">Contacto</a>
    </nav>
</header>

<section>
    <h2>Última Receta</h2>
    <p>Cómo hacer pan...</p>
</section>

<footer>
    <p>Creado en 2024</p>
</footer>`,
                exercise: {
                    instruction: "Crea una barra de navegación. Usa la etiqueta <nav> y pon dentro dos enlaces <a> (ej: Inicio y Contacto).",
                    difficulty: "Intermedio",
                    validate: (code) => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(code, "text/html");
                        const nav = doc.querySelector('nav');
                        if (!nav) return { valid: false, msg: "Necesitas la etiqueta <nav>." };
                        if (nav.querySelectorAll('a').length < 2) return { valid: false, msg: "Pon al menos dos enlaces <a> dentro del nav." };
                        return { valid: true, msg: "¡Muy bien! Eso es semántica." };
                    }
                },
                quiz: {
                    q: "¿Qué etiqueta usarías para la parte inferior de una página web?",
                    options: ["<bottom>", "<footer>", "<end>"],
                    correct: 1
                }
            },
            {
                id: "forms",
                title: "3. Pedir Datos (Formularios)",
                icon: "check-square",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 3</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Hablando con el Usuario</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <p>Las páginas web necesitan pedir información: un login, una búsqueda, un registro. Para eso usamos <strong>Formularios</strong>.</p>
                        
                        <div class="concept-box">
                            <h3 class="text-white font-bold mb-2">La etiqueta &lt;input&gt;</h3>
                            <p class="text-sm">Es la caja donde el usuario escribe. Lo mágico es el atributo <code>type</code>:</p>
                            <ul class="list-disc pl-4 mt-2 text-xs font-mono text-pink-300">
                                <li>type="text" (Texto normal)</li>
                                <li>type="email" (Obliga a tener @)</li>
                                <li>type="password" (Oculta ***)</li>
                                <li>type="date" (Calendario)</li>
                            </ul>
                        </div>
                        
                        <p class="text-sm">También podemos obligar a llenar un campo con <code>required</code> o poner un texto fantasma de ayuda con <code>placeholder</code>.</p>
                    </div>
                `,
                codeRef: `<form>
    <!-- Texto de ayuda "Email:" -->
    <label>Email:</label>
    
    <!-- Campo inteligente -->
    <input type="email" required placeholder="nombre@correo.com">
    
    <!-- Calendario -->
    <input type="date">
    
    <!-- Botón -->
    <button type="submit">Enviar</button>
</form>`,
                exercise: {
                    instruction: "Crea un campo para email. Debe ser obligatorio (required) y mostrar el texto de ayuda 'usuario@web.com' usando placeholder.",
                    difficulty: "Intermedio",
                    validate: (code) => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(code, "text/html");
                        const input = doc.querySelector('input');
                        if (!input) return { valid: false, msg: "Falta la etiqueta <input>." };
                        if (input.getAttribute('type') !== 'email') return { valid: false, msg: "El tipo (type) debe ser 'email'." };
                        if (!input.hasAttribute('required')) return { valid: false, msg: "Olvidaste poner 'required'." };
                        if (input.getAttribute('placeholder') !== 'usuario@web.com') return { valid: false, msg: "El placeholder debe ser exactamente 'usuario@web.com'." };
                        return { valid: true, msg: "¡Correcto! El navegador ahora validará el email por ti." };
                    }
                },
                quiz: {
                    q: "¿Qué atributo muestra un texto gris temporal dentro del input?",
                    options: ["value", "helper", "placeholder"],
                    correct: 2
                }
            },
            {
                id: "svg",
                title: "4. Dibujos Matemáticos (SVG)",
                icon: "pen-tool",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 4</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Imágenes que no se pixelan</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <div class="concept-box">
                            <h3 class="text-white font-bold mb-2">JPG vs SVG</h3>
                            <p class="text-sm">Una foto (JPG) son puntos de colores. Si haces zoom, se ve borrosa. Un <strong>SVG</strong> son instrucciones matemáticas ("dibuja un círculo aquí"). Si haces zoom, ¡se recalcula y se ve perfecto!</p>
                        </div>

                        <p>En HTML5 puedes escribir dibujos directamente con código:</p>
                        <ul class="list-disc pl-5 space-y-1 text-sm mb-4">
                            <li><strong>&lt;svg&gt;:</strong> Es el lienzo.</li>
                            <li><strong>&lt;rect&gt;:</strong> Un cuadrado o rectángulo.</li>
                            <li><strong>&lt;circle&gt;:</strong> Un círculo.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<!-- Lienzo de 100x100 -->
<svg width="100" height="100">
  <!-- Círculo: centro en 50,50 y radio 40 -->
  <circle cx="50" cy="50" r="40" fill="red" />
</svg>`,
                exercise: {
                    instruction: "Dibuja un rectángulo (<rect>) dentro de un <svg>. Dale un ancho (width) y alto (height) de 50.",
                    difficulty: "Avanzado",
                    validate: (code) => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(code, "text/html");
                        const svg = doc.querySelector('svg');
                        const rect = doc.querySelector('rect');
                        
                        if (!svg) return { valid: false, msg: "Necesitas el lienzo <svg>." };
                        if (!rect) return { valid: false, msg: "Dibuja el <rect> dentro del svg." };
                        if (rect.getAttribute('width') !== '50' || rect.getAttribute('height') !== '50') return { valid: false, msg: "El tamaño debe ser 50x50." };
                        
                        return { valid: true, msg: "¡Genial! Has creado un gráfico vectorial con código." };
                    }
                },
                quiz: {
                    q: "¿Qué pasa si haces mucho zoom en un SVG?",
                    options: ["Se ve borroso", "Se ve perfecto", "Desaparece"],
                    correct: 1
                }
            },
            {
                id: "storage",
                title: "5. Memoria (LocalStorage)",
                icon: "database",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 5</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Guardar Datos</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <p>Normalmente, si recargas una página, todo se borra. <strong>LocalStorage</strong> es como una pequeña libreta en el navegador donde podemos apuntar cosas para que no se olviden.</p>
                        
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700 mb-4 text-sm">
                            <h4 class="text-blue-400 font-bold mb-2">¿Cómo funciona?</h4>
                            <p class="mb-2">Funciona con pares <strong>Clave</strong> (el nombre) y <strong>Valor</strong> (el dato).</p>
                            <code class="block bg-black/30 p-2 rounded mb-2">localStorage.setItem('nombre', 'Juan');</code>
                            <p>Esto guarda "Juan" bajo la etiqueta "nombre".</p>
                        </div>
                    </div>
                `,
                codeRef: `<script>
  // 1. Guardar en la libreta
  localStorage.setItem("fruta", "Manzana");
  
  // 2. Leer de la libreta
  var dato = localStorage.getItem("fruta");
  
  // 3. Mostrarlo
  document.write("Me gusta la " + dato);
<\/script>`,
                exercise: {
                    instruction: "Usa JavaScript para guardar el valor 'HTML5' con la clave 'curso' en el localStorage.",
                    placeholder: "<script>\n  localStorage.setItem(..., ...);\n<\/script>",
                    difficulty: "Experto",
                    validate: (code) => {
                        if (!code.includes('<script>')) return { valid: false, msg: "Necesitas las etiquetas <script> para escribir JavaScript." };
                        if (!code.includes('localStorage.setItem')) return { valid: false, msg: "Usa la función localStorage.setItem()." };
                        if (!code.includes("'curso'") && !code.includes('"curso"')) return { valid: false, msg: "La clave (primero) debe ser 'curso'." };
                        if (!code.includes("'HTML5'") && !code.includes('"HTML5"')) return { valid: false, msg: "El valor (segundo) debe ser 'HTML5'." };
                        return { valid: true, msg: "¡Datos guardados! Se quedarán ahí aunque cierres el navegador." };
                    }
                },
                quiz: {
                    q: "¿Cuándo se borran los datos de LocalStorage?",
                    options: ["Al cerrar la pestaña", "Al apagar el PC", "Solo si los borras manualmente"],
                    correct: 2
                }
            },
            {
                id: "details",
                title: "6. Interactividad Simple",
                icon: "layers",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 6</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Acordeones sin JavaScript</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <p>¿Has visto esas secciones de "Preguntas Frecuentes" donde haces clic y se despliega la respuesta? Antes era difícil de hacer. ¡Ahora HTML5 lo trae de serie!</p>
                        
                        <ul class="list-disc pl-5 space-y-2 mb-6 text-sm">
                            <li><strong>&lt;details&gt;:</strong> Es la caja que envuelve todo.</li>
                            <li><strong>&lt;summary&gt;:</strong> Es el título visible (lo único que se ve al principio).</li>
                            <li>Lo que pongas después del summary estará oculto hasta que hagas clic.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<details>
  <summary>Haz clic para ver el secreto</summary>
  <p>¡Hola! Estaba escondido.</p>
  <p>Puedes poner imágenes o lo que quieras aquí.</p>
</details>`,
                exercise: {
                    instruction: "Crea un desplegable. El título (<summary>) debe decir 'Ayuda' y dentro pon cualquier texto.",
                    difficulty: "Fácil",
                    validate: (code) => {
                        const clean = code.toLowerCase();
                        if (!clean.includes('<details')) return { valid: false, msg: "Empieza con la etiqueta <details>." };
                        if (!clean.includes('<summary')) return { valid: false, msg: "Pon el título dentro de <summary>." };
                        if (!clean.includes('ayuda')) return { valid: false, msg: "El título del summary debe ser 'Ayuda'." };
                        return { valid: true, msg: "¡Pruébalo! Haz clic en el texto 'Ayuda' en la previsualización." };
                    }
                },
                quiz: {
                    q: "¿Qué etiqueta es la única visible cuando el acordeón está cerrado?",
                    options: ["<details>", "<summary>", "<hidden>"],
                    correct: 1
                }
            },
            {
                id: "a11y",
                title: "7. Accesibilidad",
                icon: "accessibility",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 7</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Web para Todos</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <div class="concept-box">
                            <h3 class="text-white font-bold mb-2">Lectores de Pantalla</h3>
                            <p class="text-sm">Las personas ciegas usan software que "lee" la web en voz alta. Si pones un botón que solo es un icono "X", el lector no sabrá qué decir.</p>
                        </div>
                        
                        <p>Para eso usamos <strong>ARIA</strong> (atributos especiales):</p>
                        <ul class="list-disc pl-5 space-y-2 mb-6 text-sm">
                            <li><strong>aria-label="Texto":</strong> Una etiqueta invisible que el lector de pantalla leerá en voz alta.</li>
                        </ul>
                    </div>
                `,
                codeRef: `<!-- Botón malo: Un ciego escucha "Botón" y ya. -->
<button>X</button>

<!-- Botón bueno: Un ciego escucha "Cerrar Ventana". -->
<button aria-label="Cerrar Ventana">
  X
</button>`,
                exercise: {
                    instruction: "Mejora un botón que solo tiene una 'X'. Añádele un atributo aria-label que diga 'Cerrar'.",
                    difficulty: "Intermedio",
                    validate: (code) => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(code, "text/html");
                        const btn = doc.querySelector('button');
                        
                        if (!btn) return { valid: false, msg: "Crea el <button>." };
                        if (!btn.hasAttribute('aria-label')) return { valid: false, msg: "Añade el atributo aria-label." };
                        if (btn.getAttribute('aria-label') !== 'Cerrar') return { valid: false, msg: "El texto del aria-label debe ser 'Cerrar'." };
                        
                        return { valid: true, msg: "¡Excelente! Has hecho la web más accesible." };
                    }
                },
                quiz: {
                    q: "¿Quién se beneficia principalmente del atributo aria-label?",
                    options: ["Los motores de búsqueda", "Usuarios de lectores de pantalla", "Diseñadores gráficos"],
                    correct: 1
                }
            },
            {
                id: "responsive",
                title: "8. Imágenes Adaptables",
                icon: "image",
                content: `
                    <span class="text-brand-500 font-mono text-xs font-bold uppercase mb-2 block tracking-widest">Capítulo 8</span>
                    <h1 class="text-3xl md:text-4xl font-extrabold text-white mb-6">Una imagen no sirve para todo</h1>
                    <div class="prose prose-invert max-w-none text-slate-300">
                        <p>Un móvil tiene una pantalla pequeña y datos limitados. Un monitor 4K es enorme. ¿Por qué enviar la misma foto gigante a los dos?</p>
                        
                        <p>La etiqueta <strong>&lt;picture&gt;</strong> nos permite dar opciones al navegador:</p>
                        <div class="bg-slate-800 p-3 rounded text-sm mt-2">
                            "Si la pantalla es grande, usa <em>foto-grande.jpg</em>. Si no, usa <em>foto-pequeña.jpg</em>."
                        </div>
                    </div>
                `,
                codeRef: `<picture>
  <!-- 1. Opción Grande (si pantalla > 800px) -->
  <source media="(min-width: 800px)" srcset="paisaje-4k.jpg">
  
  <!-- 2. Opción por defecto (Móvil) -->
  <img src="paisaje-movil.jpg" alt="Montañas">
</picture>`,
                exercise: {
                    instruction: "Crea una estructura <picture>. Debe tener al menos un <source> para pantallas grandes y un <img> obligatorio para el resto.",
                    difficulty: "Avanzado",
                    validate: (code) => {
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(code, "text/html");
                        if (!doc.querySelector('picture')) return { valid: false, msg: "Envuelve todo en <picture>." };
                        if (!doc.querySelector('source')) return { valid: false, msg: "Añade una opción con <source>." };
                        if (!doc.querySelector('img')) return { valid: false, msg: "Siempre necesitas un <img> al final como respaldo." };
                        return { valid: true, msg: "¡Perfecto! Tu web es rápida en móviles y bonita en PC." };
                    }
                },
                quiz: {
                    q: "¿Qué etiqueta dentro de picture se descarga si ninguna condición 'media' se cumple?",
                    options: ["<source>", "<img>", "<fallback>"],
                    correct: 1
                }
            }
        ];

        const progressStep = 100 / curriculum.length;

        // -------------------------------------------------------------------
        // 2. INICIALIZACIÓN Y PERSISTENCIA
        // -------------------------------------------------------------------

        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            renderSidebar();
            loadLesson(state.currentIndex);
            setupTabSupport();
            lucide.createIcons();
        });

        function loadProgress() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    state = JSON.parse(saved);
                    // Validar integridad básica
                    if (state.currentIndex >= curriculum.length) state.currentIndex = 0;
                } catch (e) {
                    console.error("Error cargando progreso", e);
                }
            }
        }

        function saveProgress() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        function resetProgress() {
            if(confirm("¿Estás seguro de reiniciar todo el progreso?")) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        // -------------------------------------------------------------------
        // 3. UI: SIDEBAR Y TABULADOR
        // -------------------------------------------------------------------

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            sidebar.classList.toggle('-translate-x-full');
            
            if (sidebar.classList.contains('-translate-x-full')) {
                overlay.classList.remove('open');
            } else {
                overlay.classList.add('open');
            }
        }

        function renderSidebar() {
            const list = document.getElementById('module-list');
            list.innerHTML = curriculum.map((item, idx) => {
                const isCompleted = state.completedLessons.includes(idx);
                return `
                <button onclick="loadLesson(${idx})" 
                    class="nav-item w-full text-left px-5 py-3.5 flex items-center gap-3 text-sm font-medium text-slate-400 hover:text-slate-200 hover:bg-slate-800/50 transition-all border-l-2 border-transparent ${idx === state.currentIndex ? 'active' : ''}">
                    <i data-lucide="${item.icon}" class="w-4 h-4 shrink-0"></i>
                    <span class="truncate">${item.title}</span>
                    ${isCompleted ? '<i data-lucide="check-circle" class="ml-auto w-3.5 h-3.5 text-green-500 shrink-0"></i>' : ''}
                </button>
            `}).join('');
            lucide.createIcons();
        }

        // Feature: Permitir Tab en el Textarea
        function setupTabSupport() {
            const textarea = document.getElementById('code-input');
            textarea.addEventListener('keydown', function(e) {
                if (e.key == 'Tab') {
                    e.preventDefault();
                    var start = this.selectionStart;
                    var end = this.selectionEnd;
                    // Insertar 2 espacios
                    this.value = this.value.substring(0, start) + "  " + this.value.substring(end);
                    this.selectionStart = this.selectionEnd = start + 2;
                }
            });
        }

        // -------------------------------------------------------------------
        // 4. LOGICA DE LECCIONES
        // -------------------------------------------------------------------

        function loadLesson(index) {
            state.currentIndex = index;
            saveProgress(); // Guardar "donde me quedé"

            const data = curriculum[index];
            
            // UI Updates
            renderSidebar(); 
            
            // Close mobile menu if open
            if(window.innerWidth < 768) {
                document.getElementById('sidebar').classList.add('-translate-x-full');
                document.getElementById('mobile-overlay').classList.remove('open');
            }
            
            // Content
            const contentDiv = document.getElementById('lesson-content');
            contentDiv.innerHTML = data.content;
            
            // Code Reference
            const codeRef = document.getElementById('reference-code');
            codeRef.innerHTML = syntaxHighlight(data.codeRef);
            
            // Preview
            updatePreview(data.codeRef);

            // Exercise Setup
            document.getElementById('workspace-area').classList.remove('hidden');
            document.getElementById('exercise-instruction').innerText = data.exercise.instruction;
            const codeInput = document.getElementById('code-input');
            codeInput.value = ""; 
            codeInput.placeholder = data.exercise.placeholder || "<!-- Tu código aquí -->";
            document.getElementById('difficulty-badge').innerText = data.exercise.difficulty;
            
            // Reset Feedback & Quiz
            const fb = document.getElementById('feedback-msg');
            fb.style.opacity = '0';
            fb.innerText = '';
            document.getElementById('quiz-container').classList.add('hidden');
            
            // Scroll to top
            document.getElementById('scroll-container').scrollTop = 0;

            updateProgressBar();
            lucide.createIcons();
        }

        function updatePreview(code) {
            const iframe = document.getElementById('preview-frame');
            const doc = iframe.contentDocument || iframe.contentWindow.document;
            
            const styles = `
                <style>
                    body { font-family: system-ui, sans-serif; padding: 20px; color: #333; } 
                    h1 { color: #0284c7; }
                    input { border: 1px solid #ccc; padding: 5px; border-radius: 4px; display: block; margin-bottom: 10px; width: 100%; box-sizing: border-box; }
                    button { background: #0284c7; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
                    button:hover { background: #0369a1; }
                    canvas, svg { border: 2px dashed #0284c7; background: #f0f9ff; margin: 10px 0; }
                    details { border: 1px solid #ddd; padding: 10px; border-radius: 5px; cursor: pointer; margin-bottom: 10px; background: #fff; }
                    summary { font-weight: bold; color: #0284c7; margin-bottom: 5px; }
                    [role="alert"] { padding: 10px; background: #fee2e2; color: #b91c1c; border-radius: 4px; margin-top: 10px; border: 1px solid #fecaca; }
                </style>`;
            
            doc.open();
            doc.write(styles + code);
            doc.close();
        }

        // -------------------------------------------------------------------
        // 5. VALIDACIÓN Y QUIZ
        // -------------------------------------------------------------------

        function validateCode() {
            const data = curriculum[state.currentIndex].exercise;
            const userCode = document.getElementById('code-input').value;
            
            // Update Preview
            updatePreview(userCode);

            // Validate
            const result = data.validate(userCode);
            const fb = document.getElementById('feedback-msg');
            
            fb.innerText = result.msg;
            fb.style.opacity = '1';
            
            if (result.valid) {
                fb.className = "w-full sm:w-auto text-xs font-bold px-3 py-2 rounded bg-green-500/20 text-green-400 border border-green-500/30 flex-1";
                setupQuiz(curriculum[state.currentIndex].quiz);
                confetti({ particleCount: 30, spread: 50, origin: { y: 0.7, x: 0.3 }, colors: ['#0ea5e9', '#22c55e'] });
            } else {
                fb.className = "w-full sm:w-auto text-xs font-bold px-3 py-2 rounded bg-red-500/20 text-red-400 border border-red-500/30 flex-1";
                const editor = document.querySelector('.code-editor-area');
                editor.classList.add('animate-pulse');
                setTimeout(() => editor.classList.remove('animate-pulse'), 500);
            }
        }

        function setupQuiz(quizData) {
            const container = document.getElementById('quiz-container');
            // Solo mostrar si no estaba ya visible para evitar saltos
            if(container.classList.contains('hidden')) {
                container.classList.remove('hidden');
                container.classList.add('animate-fade-in');
            }
            
            document.getElementById('quiz-question').innerText = quizData.q;
            document.getElementById('quiz-options').innerHTML = quizData.options.map((opt, i) => `
                <button onclick="checkQuiz(${i}, ${quizData.correct})" class="w-full text-left p-3 rounded text-sm text-slate-300 bg-slate-800 hover:bg-slate-700 hover:text-white transition-all border border-slate-700/50 hover:border-slate-500">
                    <span class="font-bold text-brand-500 mr-2">${String.fromCharCode(65 + i)}.</span> ${opt}
                </button>
            `).join('');
            
            // Smooth scroll
            setTimeout(() => {
                container.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        function checkQuiz(selected, correct) {
            const buttons = document.querySelectorAll('#quiz-options button');
            
            if (selected === correct) {
                // Estilo Correcto
                buttons[selected].className = "w-full text-left p-3 rounded text-sm bg-green-600 text-white border border-green-400 shadow-[0_0_15px_rgba(34,197,94,0.4)] transition-all transform scale-[1.02]";
                buttons[selected].innerHTML += ' <i data-lucide="check" class="inline w-4 h-4 ml-2 float-right"></i>';
                
                // Deshabilitar otros
                buttons.forEach(btn => btn.disabled = true);

                // Habilitar siguiente
                const nextBtn = document.getElementById('btn-next');
                nextBtn.disabled = false;
                nextBtn.classList.replace('bg-slate-700', 'bg-brand-600');
                
                // Update Logic State
                if (!state.completedLessons.includes(state.currentIndex)) {
                    state.completedLessons.push(state.currentIndex);
                    updateProgressBar();
                    saveProgress();
                }
                
                renderSidebar(); // Update checks
                lucide.createIcons();
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });

            } else {
                // Estilo Incorrecto
                buttons[selected].className = "w-full text-left p-3 rounded text-sm bg-red-900/50 text-red-300 border border-red-500/50 shake";
                setTimeout(() => buttons[selected].classList.remove('shake'), 500);
            }
        }

        function updateProgressBar() {
            const percentage = (state.completedLessons.length / curriculum.length) * 100;
            state.progress = percentage;
            
            document.getElementById('progress-bar').style.width = `${percentage}%`;
            document.getElementById('progress-text').innerText = `${Math.round(percentage)}%`;
            
            // Botones de navegación lógica
            document.getElementById('btn-prev').disabled = state.currentIndex === 0;
            
            const nextBtn = document.getElementById('btn-next');
            // Si la lección actual ya fue completada antes, permitir avanzar
            if (state.completedLessons.includes(state.currentIndex)) {
                nextBtn.disabled = false;
                nextBtn.classList.replace('bg-slate-700', 'bg-brand-600');
            } else {
                nextBtn.disabled = true;
                nextBtn.classList.replace('bg-brand-600', 'bg-slate-700');
            }
        }

        function nextLesson() {
            if (state.currentIndex < curriculum.length - 1) {
                loadLesson(state.currentIndex + 1);
            } else {
                showCompletionModal();
            }
        }

        function prevLesson() {
            if (state.currentIndex > 0) {
                loadLesson(state.currentIndex - 1);
            }
        }

        // -------------------------------------------------------------------
        // 6. MODAL SYSTEM
        // -------------------------------------------------------------------

        function showCompletionModal() {
            confetti({ particleCount: 500, spread: 120, origin: { y: 0.6 } });
            const modal = document.getElementById('completion-modal');
            const content = document.getElementById('modal-content');
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            // Simple animation sequence
            setTimeout(() => {
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('completion-modal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        function syntaxHighlight(code) {
            return code
                .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
                .replace(/(&lt;\/?)(\w+)(.*?)(&gt;)/g, (match, p1, p2, p3, p4) => {
                    const attrs = p3.replace(/(\w+)=(".*?")/g, '<span class="token-attr">$1</span>=<span class="token-val">$2</span>');
                    return `<span class="token-punct">${p1}</span><span class="token-tag">${p2}</span>${attrs}<span class="token-punct">${p4}</span>`;
                })
                .replace(/(&lt;!--.*?--&gt;)/g, '<span class="token-comment">$1</span>')
                .replace(/(var|let|const|document|localStorage|return)/g, '<span class="token-js">$1</span>');
        }

    </script>
</body>
</html>
